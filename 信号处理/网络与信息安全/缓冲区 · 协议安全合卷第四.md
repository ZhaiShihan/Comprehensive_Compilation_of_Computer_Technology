### 壹  缓冲区溢出与漏洞利用

##### 1. 缓冲区溢出：

- <font color="#00b0f0">议题 7 - 1</font>：常见的缓冲区溢出漏洞危机
	- WannaCry 病毒：
		- 2017 年 5 月爆发，造成了全球范围的大规模网络安全事件，影响极为严重
		- 近年来影响最广、破坏性最大的一次勒索软件攻击之一
		- 150 多个国家，超过 230000 台计算机
	- MS17 - 010：
		- WannaCry 病毒有 Windows 系统的“永恒之蓝”MS17 - 010 漏洞得以大范围传播
		- 该漏洞本质上是一个缓冲区溢出漏洞、
	- Rsync 堆缓冲区溢出漏洞（CVE-2024-12084）：
		- 精心构造溢出数据，攻击者可劫持程序执行流，最终实现远程代码执行或服务器权限接管
	- WMware ESXI 缓冲区溢出漏洞

- <font color="#00b0f0">议题 7 - 2</font>：至今无解的几种网络安全威胁

| 攻击手段    | 攻击本质         | 为什么“无解”            |
| :------ | :----------- | :----------------- |
| 缓冲区溢出   | 技术漏洞 -> 代码执行 | 永远可能有人写出漏洞代码       |
| 社会工程学   | 心理攻击 -> 信息泄露 | 人性难改，反社会工程防御很难完全奏效 |
| DDoS 攻击 | 资源消耗 -> 系统瘫痪 | 攻击门槛低、防守代价高        |

- <font color="#00b0f0">议题 7 - 3</font>：栈溢出
	- 使用一些不安全的库输入函数可能导致缓冲区溢出：`gets()`，`strcpy()`，`scanf()`，`fscanf()`，`sscanf()`
	- 溢出的防范：
		- 限制字符串读写长度：
			- `fgets(char *buf, int size, FILE *fp)` 或 `gets_s(char *buf, int size)` 代替 `gets()` 等
		- 限制在栈区域代码执行的权限：
			- 栈区域内，代码不可执行

- <font color="#00b0f0">议题 7 - 4</font>：堆溢出和 BSS 溢出
	- 堆溢出不如栈溢出流行：
		- 数据在堆中的存储不是紧挨着的，而是**有空隙的**
		- 堆溢出比栈溢出难度更大
		- 对内存中变量的组织方式有一定要求
	- BSS 中的数据存储是紧挨着的

- <font color="#00b0f0">议题 7 - 5</font>：缓冲区溢出填充代码构成
	- shellcode 是一段通常用于获取目标系统 Shell（命令行访问）的机器代码
	- 在构造溢出数据时，常常在 shellcode 前填充大量的 NOP（No Operation, 0x90）指令，主要目的是增加成功跳转到 shellcode 的概率，即使返回地址不是精确指向 shellcode 开头
	- shellcode 是完成特殊任务的自包含的二进制代码
	- shellcode 一般用于获得系统特殊权限
	- 不同硬件平台的 shellcode 不一样
	- shellcode 的入口地址即程序返回地址
	- 代码植入的几种常见模式：
		- NSR：填充 - shellcode - 返回地址
		- RNS：返回地址 - 填充 - shellcode
		- AR：环境变量 - 返回地址

##### 2. 漏洞利用与漏洞挖掘：

- <font color="#00b0f0">议题 7 - 6</font>：漏洞的类别
	- CNNVD 漏洞分级规范
		- 漏洞的危害采用**评分**或**分级**的方式进行评价，漏洞的评分由**可利用性指标组的评分**和**影响性能指标组的评分**两部分组成，一次划分漏洞危害等级
	- 高危漏洞：软件本身有极其严重的漏洞，容易被病毒、木马、黑客等侵入，导致软件崩溃或被盗取重要信息
	- 中危漏洞：入侵者不一定需要认证，就可以访问部分受限制的信息，也可以破坏部分信息禁用网站的某些页面
	- 低危漏洞：尽可能被本地利用且需要认证，成功的攻击者很难或无法访问不受限制的信息、无法破坏或损坏信息且无法制造任何系统中断

- <font color="#00b0f0">议题 7 - 7</font>：漏洞挖掘分析技术
	- 人工分析：针对被分析目标程序，**手工构造特殊输入条件**，观察输出、目标状态变化等，获得漏洞
	- Fuzzing 技术：实现原理是黑盒测试思想，主要方法是使用大量的**半有效数据**作为输入，以目标对象接受输入后是否出现异常为标志，来查找目标系统中可能存在的安全漏洞
	- 补丁对比技术：通过**比较打补丁前后的二进制文件**，确定漏洞位置，再结合其他漏洞挖掘技术，了解漏洞的细节，得到漏洞利用的攻击代码
	- 静态分析技术：**不真正运行目标程序**，通过对它的语法、语义、数据流等的分析，来进行漏洞发掘
	- 动态分析技术：在特定的容器中运行目标程序，通过目标程序在**执行过程**中的状态信息来发现潜在问题
	- 符号执行技术：用符号值替代真实值，模拟程序的执行，从而得到程序内部结构及其相关信息，从而**产生有针对性的测试用例**
	- 差分测试技术：对同一功能的不同实现（如不同编译器、库版本）输入相同数据，**比较输出差异**
	- 供应链依赖分析：扫描第三方库的已知漏洞，或利用软件成分分析（SCA）工具（如 Black Duck、Dependabot）进行分析
	- 漏洞模式匹配与 AI 驱动挖掘：基于图的漏洞匹配，使用 LSTM / GNN 学习漏洞代码特性


### 贰  协议安全和VPN技术

##### 1. 互联网协议安全概述：

- <font color="#00b0f0">议题 8 - 1</font>：网络协议安全分析
	- 网络层：IPv4 协议在设计之初没有考虑安全性，IP 包本身不具备任何安全特性，网络层的安全威胁主要有 **IP 欺骗**和 **ICMP 攻击**（单项告之）
	- 传输层：TCP 和 UDP，在设计之初没有考虑安全性，传输层的安全威胁举例：**Svn Flood（洪范）**、**利用 TCP 三次握手**
	- 应用层：包括几百种协议，Telnet 明文传输、FTP 匿名写入、SMTP 开放中继、HTTP 中间人攻击、NFS 权限逃逸等
	- 互联网安全隐患的根源是 **TCP / IP 协议的缺陷**：
		- 网络层、传输层存在安全性上的设计缺失
		- 应用层存在大量的安全隐患，可弥补
		- 在网络层、传输层提高 Internet 的安全性：
			- 网络层：IPSec 协议族
			- 传输层：SSL / TLS 协议族或 DTLS

- <font color="#00b0f0">议题 8 - 2</font>：网络安全协议的若干方法
	- 1. **数据加密？IPSec ESP**：对数据进行加密，确保数据在传输过程种不被窃取或篡改，提供机密性、完整性和可选的身份验证，用于企业内部网络间的安全通信
	- 2. **数据认证？IPSec AH**：提供数据包的完整性和认证，确保数据来源的真实性，防止数据在传输过程中被篡改，通常与 ESP 结合使用，用于金融交易等领域
	- 3. **终端防护？传输模式**：加密和保护端到端的通信数据，仅对 IP 数据包的有效荷载进行加密，主要用于单一主机与另一主机之间的安全通信
	- 4. **中间防护？隧道模式**：对整个 IP 数据包进行加密和封装，形成一个新的 IP 包进行传输，适用于网关之间的安全通信，能够在公共网络上建立安全的私有通信隧道
	- 5. **深度握手？SSL / TLS**：通过握手协议协商加密算法和密钥，验证服务器和可选的客户端身份，建立安全的加密连接，常用于网页浏览、电子邮件、即时通讯等应用
	- 6. **专网专用？VPN**：在公共网络上创建一个加密的虚拟专用网络，通过隧道技术实现远程用户与企业网络的安全连接，可用于员工安全访问公司内部资源

##### 2. 安全协议：IPSec：

- <font color="#00b0f0">议题 8 - 3</font>：IPSec
	- Internet Protocol Security，协议族 / 安全协议套件
	- IPSec 是保护 IP 协议安全通信的标准，工作在第三层（**网络层**），主要对 IP 协议分组进行加密和认证
	- IPSec 包含的具体协议：
		- AH（认证头）协议：
			- 常用协议号为 51
			- 对整个数据包（除部分字段）进行**认证**
			- **AH 没有加密性，仅提供完整性校验**，详细：RFC2402、RFC4302
			- 不对整个 IP 包头进行认证：**某些 IP 头字段在路由过程中必须被修改**（如生存时间 TTL 与头部校验）
			- 使用基于密钥的哈希算法（如 HMAC），而非简单的 Checksum 认证，主要是为了提供抗篡改能力和数据源认证（需要密钥）
		- ESP（封装安全载荷）协议：
			- 常用协议号为 50
			- 对网络包**有效载荷（payload）进行加密**
			- 详细：RFC2406、RFC4305
	- IPSec 的工作模式：
		- 1. **传输模式**：终端防护
			- 在主机上实现，**与操作系统集成**
			- 针对用户每个会话提供安全保障
			- 用于两台主机之间，保护**端到端的安全**
			- 只对 IP 数据包的有效负载进行加密或认证
			- 继续使用以前的 IP 头部，只对 IP 头部的部分域进行修改
			- 仅保护**原始 IP 数据包的有效载荷**（传输层及以上数据）
			- **AH / ESP 头通常插入在原始 IP 头和传输层头部之间**
		- 2. **隧道模式**：中间防护
			- **无需改变操作系统**
			- 为局域网内部所有应用提供服务（**网络间通信**）
			- 主机与路由器或路由器之间，**保护整个 IP 数据包**
			- 对整个 IP 数据包进行加密或认证
			- 可以选择提供认证
			- **需要新产生一个 IP 头**
			- **AH / ESP 头通常插入在原始 IP 头和新 IP 头之间**
	- IPSec 的认证头：
		- 认证头（AH）：
			- Authentication Header
			- AH 被用来保证被传输分组的完整性和可靠性
		- 下一个报头 Next header：
			- 8 bit，表示数据载荷中的封装方式或协议
		- 有效载荷长度 Payload length：
			- 8 bit，以 32 位字为单位的认证数据字段的长度
			- AH 的长度
		- 安全索引参数 SPI，Security parameters index：32 bit，为数据报识别安全关联的 32 位伪随机值
		- 序列号 Sequence Number：32 bit，单调递增的计数器，用来**防止“重放攻击”**
		- 认证数据 Authentication Data：包含了认证当前包所必须的数据，类似 checksum
	- 封装安全负载协议：
		- 封装安全负载（ESP，Encapsulating Security Payload）：用来加密
		- 包括两种方式：带有认证和不带认证，RF2406/4305
		- 加密算法：密码分组链模式的 DES（CBC - DES）、3DES、RC5、IDEA、CAST、Blowfish、其他算法
		- ESP 也有传输模式和隧道模式两种工作模式
	- IPSec 实例：
		- 使用场景：本地配置 IPSec，通常与 VPN 技术结合使用
		- 尽管“看不见”它，却常常在背后默默保护数据安全


| 组合方式       | 是否加密 | 是否认证 | 是否保护原始 IP 头 | 应用场景简述            | 说明管检测                |
| :--------- | :--- | :--- | :---------- | :---------------- | :------------------- |
| AH + 传输模式  | No   | Yes  | No          | 主机之间的完整性校验与身份认证   | 不加密，仅校验数据部分          |
| AH + 隧道模式  | No   | Yes  | Yes         | 网关之间认证传输          | 封装整个 IP 包进行认证        |
| ESP + 传输模式 | Yes  | Yes  | No          | 主机到主机的加密通信        | 加密数据部分，保留原始 IP 头     |
| ESP + 隧道模式 | Yes  | Yes  | Yes         | 常用于 VPN，保障全链路安全通信 | 加密和认证整个 IP 包，新增 IP 头 |

| IPSec 使用场景 | 使用方式                                     |
| :--------- | :--------------------------------------- |
| VPN（常见）    | 配置 IPSec VPN，支持 L2TP/IPSec 或 IKEv2/IPSec |
| 操作系统级别     | Windows、Linux、macOS 内置支持 IPSec 协议        |
| 企业网络设置     | 路由器、防火墙、网关中配置 IPSec 通道                   |
| 云服务中       | 配置云平台（如 AWS、Azure）中的 IPSec VPN 连接        |

##### 3. 安全协议：SSL（TLS）：

- <font color="#00b0f0">议题 8 - 4</font>：SSL（TLS）
	- SSL，Secure Sockets Layer，安全套接层
	- TLS，Transprot Layer Security，传输层安全
	- 是提供安全及数据完整性的安全协议，位于**应用层和 TCP 网络层之间的可选层**，对网络通信数据进行加密，与应用层协议无关
	- “Client Hello” 消息：客户端告知服务器其支持的 SSL / TLS 版本、加密套件等信息
	- “Server Hello” 消息：服务器告知客户端其支持的 SSL / TLS 版本、加密套件等信息
	- 通常使用**数字证书**来验证服务器身份
	- SSL 的通信目标：
		- **机密性**
		- **完整性**
		- **不可否认性（身份认证）**
	- SSL 协议的组成：
		- SSL **记录协议**
		- **握手协议**
		- **密钥更改协议**
		- **告警协议**
		- “我即告密”
	- SSL 会话过程：
		- 建立连接时需要“握手过程（handshake）”**深度握手**
		- 目的是为了：
			- **协商加密**算法（谁支持什么加密方式）
			- 完成**身份认证**（通常服务器出示）
			- 安全地协商出一个对称加密的**密钥**（真正用于传输加密的）
	- SSL 已淘汰，TLS 是现实中的标准协议；虽然人们还习惯说“SSL”证书，但实际上我们用的都是 TLS 协议

##### 4. 安全协议：DTLS：

- <font color="#00b0f0">议题 8 - 5</font>：DTLS
	- Datagram Transport Layer Security，数据报**传输层**安全
	- 提供了基于 **UDP** 传输场景下的安全解决方案
	- DTLS 协议由记录协议、握手协议、密钥更改协议、告警协议组成
	- 与 SSL / TLS 的区别：
		- 握手防护机制：
			- 超时重传机制：增加了超时重传机制来确定握手消息到达
			- 序列号：增加字段便于接收方处理乱序消息
			- 报文大小限制
			- cookie 验证机制具体实现（防 DoS / DDoS）
		- 能够额外处理的主要问题：数据包的丢失、乱序和重放
	- DTLS 实例：抓取 DTLS 数据：使用 Wireshark 抓包展示 DTLS 数据

##### 5. VPN 技术：

- <font color="#00b0f0">议题 8 - 6</font>：VPN
	- VPN：Virtual Private Network，虚拟专用网络
	- VPN 技术的核心思想：在公共网络中放置一个**加密逻辑隧道**
	- 安全性非常高、方便、成本低
	- VPN 的应用：组建企业内联网、组建企业外联网、完成远程用户访问
	- VPN 的关键技术：隧道技术、加解密技术、认证技术
	- VPN 的种类：SSL/TLS VPN 或 DTLS VPN；IPSec VPN
	- IPSec VPN 可以进入所有内部网络，SSL VPN 不可以；SSL VPN 可以在任何计算机都可以使用，IPSec VPN 不可以

- <font color="#00b0f0">议题 8 - 7</font>：OpenSSL
	- OpenSSL 是一个功能丰富且自包含的开源安全工具箱，采用 C 语言作为开发语言
	- OpenSSL 主要用于创建证书、生成非对称密钥对、测试 SSL / TLS 连接等
	- 数字证书是由受信任的证书颁发机构（CA）签发的一种电子凭证，它将一个实体（如网站、个人）的身份信息与其公钥绑定在一起

### 叁  智能安全与数字媒体安全

##### 1. 智能系统安全：

- <font color="#00b0f0">议题 9 - 1</font>：智能系统安全
	- 智能系统特征：
		- 1. 模型赋能：利用人工智能模型来增强和改进媒体内容的制作和交付
		- 2. 数据驱动：数据作为人工智能的燃料，为其提供了源源不断的信息输入
		- 3. 用户交互：智能系统与用户或环境进行交互，并在交互中实现学习与建模
	- 智能系统安全挑战：
		- 1. 算法模型安全：模型安全、算法偏见
			- **模型安全**：
				- 对抗攻击：对输入样本故意添加一些人类无法察觉的细微干扰（形成对抗样本），导致模型产生错误的输出结果；根据攻击者掌握的信息（模型的参数、结构），可分为黑盒攻击/白盒攻击
				- 逃逸攻击：对抗样本攻击中一个重要的例子，在不改变目标模型的情况下，通过构造特定输入样本以完成欺骗目标系统的攻击
				- 投毒攻击：将少量精心设计的中毒样本添加到模型训练集中，破坏模型可用性或完整性（标签修改、数据修改、数据注入）（模型偏斜攻击，反馈化武器、后门攻击）
				- 模型窃取（萃取）攻击：攻击者通过发送轮询数据并查看对应的相应结构，推测 AI 模型的参数或功能，复制一个功能相似甚至完全相同的 AI 模型
				- 防御策略：**模型优化/加固**，**输入数据预处理/过滤**，**模型水印**
			- **算法偏见**：
				- 输入数据偏见 + 算法规则偏见
				- 公平性提升技术：**平衡数据集**、**公平性度量**、**数据预处理和清洗**、**可解释性技术**、**透明度和可追溯性**
		- 2. 数据隐私安全：黑客攻击、数据泄露
			- **成员推理攻击** Membership Inference Attack：攻击者的目的是判断某个目标输入样本是否存在目标模型的训练数据集中，是一种黑盒攻击
			- **模型逆向攻击** Model Inversion Attack：通过模型的输出，反推训练集中某条目标数据的部分或全部属性值，有黑/白盒攻击两种
			- 智能数据保护：**信息混淆**、**查询控制**、**隐私计算**、**模型叠加**、**法律法规**
		- 3. 应用部署安全：底层框架漏洞、依赖库漏洞
			- AI 框架——终端模块漏洞
			- AI 框架——云端模块漏洞
			- AI 框架依赖库漏洞
			- 防护技术与策略：**代码审查**、**安全测试**、**入侵检测系统**、**漏洞监控与版本更新**

##### 2. 数字媒体安全：

- <font color="#00b0f0">议题 9 - 2</font>：数字媒体的安全特性
	- 基本安全特点：机密性、完整性、可用性、可控性、不可否认性
	- 附加安全特点：内容真实性、社会影响性、感官冗余性、产权归属性

- <font color="#00b0f0">议题 9 - 3</font>：典型数字媒体安全
	- 文本媒体安全：文本隐写技术
	- 音频媒体安全：音频攻击技术
	- 图像媒体安全：伪造检测技术
	- 视频媒体安全：内容审核技术
	- 游戏媒体安全：软件安全技术

