### 壹  网络信息安全概述

##### 1. 基础概念：

- <font color="#ffc000">议题 1 - 1</font>：网络安全事件分析
	- 斯诺登事件——数据泄露与监视（监控和分析国内和国际通信）
	- 心脏滴血事件——SSL 是最为普遍的网络加密技术，Glibc事件（scanf/printf）——安全问题一直存在——**基于缓冲区溢出的漏洞是目前网络入侵的最主要手段**
	- 滴滴罚款事件——非法获取用户信息
	- 微软高管账户泄露——网络攻击具有**定向**、**隐蔽**、**持续**的特点
	- 黎巴嫩寻呼机爆炸——网络攻击正在从虚拟领域向现实物理世界扩展
	- Deepseek 遭受了 DDOS 攻击——DDOS 只是烟雾弹，黑客在 API 渗透和权重投毒中，精准注入了对抗样本，甚至对 Deepseek 的长期渗透痕迹

- <font color="#ffc000">议题 1 - 2</font>：网络信息安全发展的几个阶段
	- 通信保密阶段：20 世纪初期，侧重于密码学，研究通讯安全为主，主要解决信息传输中的保密问题
	- 信息安全阶段：20 世纪 60 年代，以保密性、完整性和可用为目标，开始关注信息存储和处理的安全性
	- 网络信息系统安全阶段：20 世纪 90 年代，从整体角度考虑体系建设的信息保障阶段，强调综合防御和风险管理
	- 现在：网络空间安全阶段？智能安全阶段？安全失控阶段？

- <font color="#ffc000">议题 1 - 3</font>：现代网络威胁
	- **特洛伊木马**（单向作用于网络与信息系统）
	- **黑客攻击**（单向作用于网络与信息系统）
	- **后门、隐蔽通道**（单向作用于网络与信息系统）
	- **计算机病毒**（单向作用于网络与信息系统）
	- **拒绝服务攻击**（单向作用于网络与信息系统）
	- **内部、外部泄密**（*与网络与信息系统双向作用*）
	- **蠕虫**（单向作用于网络与信息系统）
	- **高级可持续威胁攻击 APT**（单向作用于网络与信息系统）
	- **信息丢失、篡改、销毁**（单向作用于网络与信息系统）

- <font color="#ffc000">议题 1 - 4</font>：网络信息安全的一些经典结论
	- 公理 1：所有的程序都有缺陷
	- 定理 1：大程序的缺陷甚至比包含的内容还多
		- 推理 1 - 1：一个安全相关程序也有安全性缺陷
	- 定理 2：只要不运行这个程序，是否有缺陷，也无关紧要
	- 定理 3：对外暴露的计算机，应尽可能少地运行程序，且运行的程序也应尽可能小

- <font color="#ffc000">议题 1 - 5</font>：网络信息安全趋势
	- 1. 集团化、产业化趋势（国家化）
	- 2. “黑客”逐渐变成犯罪职业
	- 3. 恶意软件转型 -> 钓鱼软件（我国仍然是恶意软件最多的国家）
	- 4. 网页挂马危害继续延续
	- 5. 一剑封喉：利用应用软件漏洞的攻击将更为迅猛
	- 6. Web 2.0、3.0 的产品将受到挑战（社区网站上带有社会工程学性质的欺骗往往超过安全软件所保护的范畴）
		- 注：**社会工程学**是一种通过对受害者心理弱点、本能反应、好奇心、信任、贪婪等心理陷阱进行诸如欺骗、伤害等危害手段；社会工程学陷阱就是通常以交谈、欺骗、假冒或口语等方式，从合法用户中套取用户系统的秘密
	- 7. 隐私泄露和网络舆论是安全发展的新趋势
	- 8. 其他安全趋势

- <font color="#ffc000">议题 1 - 6</font>：网络安全的特点
	- **机密性**：杜绝有用信息泄露给非授权个人或实体
	- **完整性**：信息保持非修改、非破坏和非丢失
	- **可用性**：可被授权实体正常访问
	- **可控性**：对网络中信息传播及内容能实现有效控制
	- **不可否认性**：所有参与者不可否认或者抵赖本人的真实身份

##### 2. 行业形势：

- <font color="#ffc000">议题 1 - 7</font>：网络强国建设
	- 2018 年 4 月 20 日至 21 日
	- 全国网络安全和信息化工作会议召开
	- 主题：**网络强国建设**
	- “没有网络安全就没有国家安全”
	- “我们必须敏锐抓住信息化发展历史机遇，自主创新推进网络强国建设”
	- **中国的信息安全保障进入到等级保护阶段！**：《中华人民共和国信息安全等级保护管理办法》
	- CNCERT/CC（“国家互联网应急中心”）

- <font color="#ffc000">议题 1 - 8</font>：常见信息安全产品
	- 从网络安全系统角度：**防火墙、入侵检测/入侵防护、虚拟专用网（VPN）、抗 DDOS 系统（流量清洗）、网络行为审计、统一威胁管理系统（UTM）**
	- 网络安全老三样：**防火墙**、**入侵检测**、**防病毒**

- <font color="#ffc000">议题 1 - 9</font>：网络信息安全的哲学思考
	- 网络信息安全的哲学本质：矛与盾的对抗
	- 网络信息安全的本质：“打破规则”


### 贰  密码算法和密码学

##### 1. 密码学基本概念：

- <font color="#ffc000">议题 2 - 1</font>：加密和解密
	- 加密是把数据和信息转换为不可识别的密文的过程
	- 解密是恢复数据和信息本来面目的过程
	- 早期密码学以**语言学**为基础
	- 古罗马凯撒密码（Caesar）：$c=(m+3)\ Mod\ 26$，$m$ 是明文，$c$ 是密文（如 A 对应密文是 D，Z 对应 C）
	- 美国南北战争：行列变换密码
	- 现代密码学：主要在二进制字串上进行，密码方法所基于的问题**只要被证明无法有效解出，就是安全**，主要威胁为暴力破解的速度和量子计算的发展

- <font color="#ffc000">议题 2 - 2</font>：密码学的基本术语
	- 明文：plaintext，原有的信息
	- 密文：ciphertext，明文经过加密变换后的内容
	- 加密函数：Encryption，用来加密的数学函数
	- 解密函数：Decryption，用来解密的数学函数
	- 明文 $P$ 在加密密钥 $k$ 下通过加密函数 $C=E_k(P)$ 得到密文 $C$，再在解密密钥 $k^{-1}$ 下通过解密函数 $P=D_k^{-1}(C)$ 恢复为明文 $C$
	- 古典密码和现代密码算法根据**算法和密钥是否分开**来区分
	- 古典密码体制的安全性依赖于**算法本身的保密性**，不适合大规模生成，不适合较大的或者人员变动频繁的组织，用户无法了解算法的安全性
	- 古典密码算法种类：
		- **代码加密**：“代码”指专有词汇或者特殊用语，“黑话”
		- **替换加密**：用一组密文字母代替一组明文字母，但保持明文的顺序（如凯撒密码）
		- **变位加密**：对明文字母作重新排序（如南北战争行列变换密码）
		- **一次性加密**：利用代码本，结合上述方法，用代码本上每一页加密明文的一个片段
	- 现代密码算法：把算法和密钥分开——密码算法可以公开，密钥保密
	- 现代密码系统的安全性依赖于**密钥的保密性**，密码算法可以经过充分论证，安全性有保证，对密码系统的管理简单，可应用于大规模场景

- <font color="#ffc000">议题 2 - 3</font>：密码算法的分类
	- 根据**加密和解密是否使用相同的密钥**来区分：
		- **对称密钥密码**：也称“单钥体制”，$k=k^{-1}$，加密速度快，使用简单；密钥分配必须通过保密通道进行，$n$ 个用户需要 $n(n-1)$ 个（对）密钥
		- **非对称密钥密码**：也称“公开密钥密码体制（Public Key Infrastructure，PKI）”，加密和解密使用不同的密钥 $(k,k^{-1})$，把**加密密钥公开（公钥），解密密钥保密（私钥）**，对于每一个用户形成“公私密钥对”；密钥的分配不必保持通信的保密性，$n$ 个用户需要 $n$ 对密钥；算法速度比对称密钥算法慢 $10$ 倍左右（软件）
		- **混合加密体系**：结合对称密钥密码和非对称密钥密码体系，采用对称方法进行通信，采用 PKI 体系进行密钥交换（对信息进行对称密钥加密，对密钥进行非对称密钥加密）
	- 根据**每次操作的数据单元是否分块**来区分：
		- 分组密码（Block Cipher）：一次加密或解密操作作用于一个数据块，比如 64 bit；数据块之间加密是**独立**的
		- 序列密码（Stream Cipher）：一次加密或解密操作作用于一位或者一个字节，前部分密文参与后部分明文的加密，数据块之间加密**不独立**
	- 根据**明文加密后是否需要还原**来区分：
		- 双向加密：明文加密后需要解密，目的是信息的交换，保障数据的**机密性**
		- 单向加密：明文加密后不需要解密，目的验证数据的**完整性**
	- 根据**算法和密钥是否分开**来区分：古典密码、现代密码

##### 2. 对称密钥密码算法：

- <font color="#ffc000">议题 2 - 4</font>：常用的对称密钥密码算法
	- **DES**、**3DES**
	- **AES**
	- IDEA
	- CAST - 128
	- RC2、**RC4**、RC5
	- Blowfish

- <font color="#ffc000">议题 2 - 5</font>：DES 系列算法
	- <font color="#00ffb0">DES 算法</font>是一个**分组加密算法**，以 **64 bit 为一个分组**
	- DES 算法使用标准的算术和逻辑单元
	- 2001 年，DES 算法已经不再推荐使用，被安全性更强的 AES 算法所取代
	- 总体框架：明文分成 64 bit 为单位的 $m$，密钥为 56 bit（除去第 8，16，……，64 位这 8 个校验位）
	- 三步：$DES(m)=FP\cdot T_{16}\cdot T_{15}\cdot\ldots T_2\cdot T_1\cdot IP(m)$
		- 1. 初始置换（Initial Permutation，IP）
		- 2. **16 轮迭代**，$T_i$，$i=1,2,\ldots,16$
		- 3. 末置换（Final Permutation，FP）
		- $IP\cdot FP=I$，$FP=IP^{-1}$
		- 对 $m$ 中 64 个位置进行置换
		- 输入：$m=m_1m_2\cdots m_{64}$
		- 输出：$m^{'}=m_{58}m_{50}\ldots m_{23}m_{15}m_7$
	- E - 盒置换（Expansion Box）：
		- 将 32 位扩展成 48 位
		- 目的是**扩大数据宽度**，便于与 48 位轮密钥逐位疑惑（XOR）；**引入扩散**，单一位变化通过重复位影响（“放大镜” + “搅拌器”）
	- S - 盒置换（Substitution Box）：
		- 将 48 位压缩成 32 位，实现核心混淆
		- $S_i$ 输入 6 位，**查表**输出 4 位（“密码字典”）
		- 增加了算法的非线性性
	- P - 盒置换（Permutation Box）：
		- 32 位输入 32 位输出
		- 仅置换位置（“洗牌器”）
	- DES 算法每次迭代重复执行：E - 盒替换、S - 盒替换、P - 盒替换
	- DES 的解密过程与加密十分相似，不同是将 16 次迭代的顺序颠倒，可以证明 $DES^{-1}(DES(m))=m$
	- **DES 安全性不足源自密钥太短**
	- <font color="#00ffb0">Triple DES（3DES）算法</font>：密钥长度是 112 比特，$k=k_1k_2$，密钥数量：$2^{112\ or\ 168}$

- <font color="#ffc000">议题 2 - 6</font>：几种常见对称密钥密码算法比较

| 算法         | 密钥长度         | 迭代次数   | 数学操作            | 应用            |
| :--------- | :----------- | :----- | :-------------- | :------------ |
| `DES`      | `56`         | `16`   | `XOR, S-Box`    |               |
| `3DES`     | `112 or 168` | `48`   | `XOR, S-Box`    | `PGP, S/MIME` |
| `IDEA`     | `128`        | `8`    | `XOR, +, ×`     | `PGP`         |
| `BlowFish` | `最大 448`     | `16`   | `XOR, S-Box, +` |               |
| `RC5`      | `最大 2048`    | `<255` | `+, -, XOR`     |               |
| `CAST-128` | `40 - 128`   | `16`   | `+, -, S-Box`   | `PGP`         |

- <font color="#ffc000">议题 2 - 7</font>：AES 算法
	- AES 也是一个**分组加密算法**，区块长度固定为 128 位
	- AES 密钥长度**可以为 128、192 或 256 位**
	- AES 的总体框架：
		- 明文分成 128 位区块
		- 对于每个区块，执行如下操作：字节替换（Sub Bytes）、行移位（Shift Rows）、列混淆（Mix Columns）、**轮密钥加**（Add Round Key，128 位，异或操作）
		- 解密过程为对应逆操作

- <font color="#ffc000">议题 2 - 8</font>：RC 系列算法
	- 2002 年图灵奖获得者 Ronald Rives 在 1987 年设计 RC4 算法（Ron's Code 4，Rivest Cipher 4）
	- RC4 算法是**密钥长度可变的流加密算法簇（序列加密算法）**，其核心部分的 S - Box 长度可为任意，但一般为 256 字节，该算法速度是 DES 算法的 10 倍
	- 思想：RC4 产生一个伪随机 bit 流，与输入流明文逐位产生异或；解密时，用密文与伪随机 bit 流逐位异或产生明文（异或操作是具有对称性的）
	- 算法关键：根据密钥产生伪随机 bit 流，使用一个 256 位的转换器（S-Box），以及两个指针
	- 密钥的使用（密钥调度算法）：对于变长密钥，应用它置换 S-Box；伪代码，其中 S 为一个字节数组
	- 伪随机流产生算法：RPGA，pseudo-random generation algorithm，每周期 $i$ 增加 $1$，$j$ 增加 $S[i]$，每次运算可输出一个 Byte

- <font color="#ffc000">议题 2 - 9</font>：对称密钥密码系统的缺点
	- 1. 密钥分发需要经过安全通道
	- 2. 无法用于鉴别身份（数字签名）
	- 3. 密钥管理复杂：$O(n^2)$

##### 3. 非对称密钥密码算法：

- <font color="#ffc000">议题 2 - 10</font>：非对称密钥密码系统的特点
	- 1. 两个密钥，一公一私
	- 2. 对密钥分配、数字签名、认证等具有深远影响
	- 3. 相关算法真正基于数学理论，而不是代替和换位
	- 4. 密码学史上一次真正意义的革命

- <font color="#ffc000">议题 2 - 11</font>：非对称密钥密码算法
	- 加密原理（信息接收）：
		- 每个通信实体有一对密钥：**公钥公开，用于加密和验证签名；私钥保密，用作解密和签名**（柯克霍夫原则，Kerckhoffs's Principle）
		- A 向 B 发送消息，用 B 公钥加密；B 收到后，用其私钥解密
	- 签名原理（来源证明）：
		- A 向 B 发送消息，用 A 的私钥加密——**签名过程**
		- B 收到明文后，用 A 的公钥解密——**验证签名过程**
	- 签名和加密同时使用（可证明来源的信息接收）：
		- A 向 B 发送消息，用 A 的私钥加密（签名），再用 B 的公钥加密
		- B 收到密文后，用 B 的私钥解密，再用 A 的公钥解密（验证签名）
	- 与对称密钥算法同时使用（高速数据加密传输）：
		- **对称密钥算法加密消息，非对称密钥算法加密密钥**
		- A 用随机密钥 k 进行加密，随机密钥 k 用 B 的公钥加密
		- B 接收后用 B 的私钥解密出随机密钥 k，再用随机密钥 k 解密
		- 非对称密钥加密算法对密钥加密，比对信息直接加密更快速

- <font color="#ffc000">议题 2 - 12</font>：非对称密钥密码算法要求
	- 参与双方 A 和 B 都包含一对密钥，且密钥产生容易 $(k_a,k_a^{-1})$ 和 $(k_b,k_b^{-1})$，A 向 B 发送消息
	- 已知 $k_b$，A 的加密操作是容易的，$C=E_{kb}(P)$
	- 已知 $k_b^{-1}$，B 对密文解密操作是容易的，$P=D_{kb^{-1}}(C)$
	- 已知 $k_b$，求 $k_b^{-1}$ 在计算上不可行（由公钥无法计算私钥）
	- 仅知 $k_b$ 和 $C$，恢复 $P$ 在计算上不可行（仅知公钥，无法破解）

- <font color="#ffc000">议题 2 - 13</font>：非对称密钥密码算法的理解
	- 非对称密钥算法相对**很慢**，适合用在数字签名和密钥管理等片段加密的情况
	- 对称密钥没过时，并且仍然是**主流方法**
	- 任何一种算法的安全性都依赖于**密钥的长度**和**破解的工作量**，从密码分析角度来说，对称密钥加密和非对称密钥加密具有同样优势

- <font color="#ffc000">议题 2 - 14</font>：常用的非对称密钥密码算法
	- Diffie - Hellman 密钥交换协议
	- EIGamal
	- **RSA**
	- **ECC，椭圆曲线**
	- Cramer - Shoup 算法

- <font color="#ffc000">议题 2 - 15</font>：RSA 算法
	- 2002 年图灵奖获得者 Ron **R**ivest，Adi **S**hamir，Leonard **A**dleman
	- RSA 安全性**基于分解极大数的困难性**（两素数积的因式分解）
	- 至今，只有短的 RSA 密钥才可以被强力破解
	- 至今，世界上还没有任何可靠的攻击 RSA 算法的方式
	- **只要密钥足够长，RSA 加密的信息在计算上不能被破解**
	- RSA 算法于 1977 年以论文形式发表，1983 年在美国申请了专利，U.S.Patent 4405829，但已经过时，其他国家没有被授予专利
	- 数论基础 + 欧拉函数 + 欧拉定理
	- 一般使用 1024 位密钥，证书认证机构采用 2048 位
	- 算法组成：
		- 密钥生成算法：
			- 取两个大素数 $p$，$q$，保密
			- 计算 $N=pq$，公开 $N$
			- 计算欧拉函数 $\Phi(N)=(p-1)(q-1)$
			- 任意取一个与 $\Phi(N)$ 互素的整数 $e$，即 $1\textless e\textless \Phi(N)$，$e$ **作为公钥公开**
			- 寻找 $d$，使得 $de\equiv1\ mod\ \Phi(N)$，$d$ **作为私钥保密**
		- 加密算法：
			- 密钥对：$(\{e,N\},\{d,N\})$
			- 把待加密内容分成 $k$ 比特分组，$k\leq log_2N$，写成数字 $M$，则 $C=M^e\ mod\ N$
		- 解密算法：
			- $M=C^d\ mod\ N$
			- 可以证明，解密是正确的
	- RSA 算法的安全性：
		- 攻击方法：
			- 蛮力攻击：尝试所有密钥
			- 密码分析：等效于对两个素数乘积 N 的因子分解（求 $p$ 和 $q$）
	- RSA 的算法性能：
		- 软件实现比 DES 软件慢 100 倍
		- 硬件实现比 DES 硬件慢 1000 倍

- <font color="#ffc000">议题 2 - 16</font>：ECC 椭圆曲线密码系统
	- Elliptic Curve Cryptography，缩写为 ECC
	- **理论基础是解决椭圆曲线离散对数的困难性**
	- 椭圆曲线离散对数难题：
		- $K=kG$，其中 $K$，$G$ 为曲线 $E_p(a,b)$ 上的点，$k$ 为小于 $n$ 的整数，$n$ 为点 $G$ 的阶 
		- 给定 $k$ 和 $G$，容易计算 $K$
		- 反之，给定 $K$ 和 $G$，较难计算 $k$
		- 因此，设定 $K$ 为公钥，$k$ 为私钥，$G$ 为基点
	- 算法优势：
		- 主要优势是使用**更短的密钥**达到与 RSA  相同的安全性
		- 160 位密钥可达到 RSA 1024 位密钥的安全性，甚至**更高**
		- 计算量较小，**处理速度快**，存储空间和传输带宽占用较少

##### 4. 单向散列加密算法

- <font color="#ffc000">议题 2 - 17</font>：常见单向散列加密算法
	- 单向散列函数最主要的应用目的是实现身份认证
	- MD5 系列算法
	- SHA 系列算法（目前 SHA-1 已淘汰，**王小云教授破解**，主流选择为 SHA-2，SHA-3 是 NIST 标准化算法，在逐步推广中）
	- 碰撞攻击：
		- 定义：找到两个不通输入产生相同哈希值
		- 存在严重安全影响，导致数字签名失效：攻击者可伪造合法签名文件

- <font color="#ffc000">议题 2 - 18</font>：MD5 算法
	- 1992 年，有 Ronald Rivest 设计
	- MD（Message Digest，信息摘要算法），MD2，MD3，MD4，MD5，MD6
	- **对任意输入均产生 128 bit 的输出**
	- 基于 32 位的简单操作，易于软件实现
	- 简单而紧凑，没有辅助的程序和大数据结构
	- 详细：RFC 1321
	- 安全性：
		- 128 位的信息摘要找到“碰撞”是可能的
		- 2004 年，**王小云**证明 **MD5 数字签名算法可以产生碰撞**（分钟级碰撞**破解**）
		- 2008 年，荷兰埃因霍芬技术大学科学家把 2 个可执行文件进行 MD5 碰撞，使使运行结果不同的程序计算出相同 MD5
		- 2008 年，通过 MD5 碰撞成功生成了伪造的 SSL 证书

- <font color="#ffc000">议题 2 - 19</font>：典型密码应用
	- **HTTPS 证书：AES 加密 + RSA 密钥交换 + SHA - 256 验证**
	- 资源完整性校验：MD5
	- 数字证书：SHA1 with RSA，SHA 384 ECDSA

##### 5. 前沿密码技术：

- <font color="#ffc000">议题 2 - 20</font>：量子计算威胁
	- 量子计算机利用量子叠加和纠缠特性，可在特定问题上实现指数级加速
	- Shor 算法（1994）：快速分解大整数与求解椭圆曲线离散对数，破解 2048 位 RSA 仅需数小时，而传统计算机需数亿年
	- Grover（1996）：加速无序数据库搜索，影响对称加密与哈希函数的安全性，导致对称算法密钥强度减半，AES -256 在量子下安全性相当于 AES - 128
	- **已证明理论威胁，但目前量子计算机规模不足**
	- “先存储后加密”
	- 若量子计算机突破百万量子比特门槛，RSA / ECC 算法将彻底失效

- <font color="#ffc000">议题 2 - 21</font>：后量子加密（Post - Quantum Cryptography，PQC）
	- **抵抗量子计算机攻击**的加密算法
	- 多数后量子算法比 RSA / ECC 慢 10 - 100 倍，需要硬件加速支持

