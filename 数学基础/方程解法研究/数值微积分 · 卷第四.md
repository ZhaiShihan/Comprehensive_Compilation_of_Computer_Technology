### 壹  数值积分

#### 1. 基于积分中值定理的数值积分：

##### 对称求积公式：

- 在工程和科学实验中，经常要计算定积分 $\int_a^b f(x)dx$，某些情况下需要数值积分法帮助：
	- 1. 被积函数的原函数不能用初等函数表示
	- 2. 被积函数的原函数过于复杂
	- 3. 原函数以表格形式给出

- 数值积分级别思想：用简单函数近似替代被积函数，然后建立如下求积公式：$$\int_a^b f(x)dx\approx A_0 f(x_0)+A_1 f(x_1)+\cdots+A_n f(x_n)=\Sigma_{i=0}^n\ A_i f(x_i)$$

- 积分中值定理：连续函数 $f(x)$ 在 $[a,b]$ 内存在一点 $\xi$，使得 $I(f)=\int_a^b f(x)dx=(b-a)f(\xi)$（从几何意义上讲，$f(\xi)$ 为 $f(x)$ 在区间 $[a,b]$ 上的平均高度）

- 假设 $f(x)$ 为被积函数，其积分区间为 $[x^{'},x^{''}]$，可以考虑将积分区间分成 $n+1$ 个小区间，则每个小区间的宽度为：$$h=\frac{x^{''}-x^{'}}{n+1}$$在中间 $n$ 个节点分别取函数值 $f(x_i)$，$i=0,1,2,\cdots,n$，其中：$$x_i=x^{'}+i\cdot h$$

- 用插值法计算小区间中某点函数值，采用“拉格朗日插值法 Lagrange Interpolation”建立插值多项式 $L_n(t)$，其中 $x=x^{'}+th$，即 $t=\frac{x-x^{'}}{h}$，则原积分可以转化为：$$I=\int_{x^{'}}^{x^{''}}f(x)dx=h\cdot\int_{t^{'}}^{t^{''}}f(x_0+ht)dt$$其中 $[t^{'},t^{''}]$ 是对应于 $[x^{'},x^{''}]$ 的变量，通常取 $t^{'}=0$，$t^{''}=n$$$f(x_0+ht)=L_n(t)+R_n(t)$$$$\Rightarrow\ I=h\cdot\int_{t^{'}}^{t^{''}}f(x_0+ht)dt=h\cdot\int_{t^{'}}^{t^{''}}L_n(t)\ dt+h\cdot\int_{t^{'}}^{t^{''}}R_n(t)\ dt=Q+R$$$R_n(t)$ 为插值多项式余项，$R=h\cdot\int_{t^{'}}^{t^{''}}R_n(t)\ dt$ 为误差累积

- 拉格朗日插值多项式为：$$L_n(t)=\Sigma_{i=0}^n\ f(x_i)\cdot\mathscr{l}_i(t)$$其中 $\mathscr{l}_i(t)$ 是拉格朗日基函数：$$\mathscr{l}_i(t)=\Pi_{0\leq j\leq n,\ j\neq i}\ \frac{t-j}{i-j}$$将插值多项式代入积分表达式：$$Q=h\cdot\int_{t^{'}}^{t^{''}}L_n(t)\ dt=h\cdot\int_{t^{'}}^{t^{''}}\Sigma_{i=0}^n\ f(x_i)\cdot\mathscr{l}_i(t)\ dt=h\cdot\Sigma_{i=0}^n\ f(x_i)\int_{t^{'}}^{t^{''}}\mathscr{l}_i(t)\ dt$$定义求积公式的系数 $C_i$：$$C_i=\int_{t^{'}}^{t^{''}}\mathscr{l}_i(t)\ dt$$因此积分主体 $Q$ 可以表示为：$$Q=h\cdot\Sigma_{i=0}^n\ C_if(x_i)$$

- 在误差允许的范围内，可以认为：$$I\approx Q=h\cdot\Sigma_{i=0}^n\ C_if(x_i)$$由于系数 $C_i=C_{n-i}$ 具有对称性，故该公式又称“对称求积公式”


- 总结：对称求积公式：$$I=\int_{x^{'}}^{x^{''}}f(x)dx=h\cdot\int_{t^{'}}^{t^{''}}f(x_0+ht)dt=Q+R$$其中：$$Q=h\cdot\Sigma_{i=0}^n\ [\int_{t^{'}}^{t^{''}}\frac{(-1)^{n-i}t^{[n+1]}}{i!(n-i)!(t-i)}dt\ ]\ f(x_i)=h\cdot\Sigma_{i=0}^nC_if(x_i)$$$$R=h\cdot\int_{t^{'}}^{t^{''}}R_n(t)dt$$

##### 牛顿 - 柯特斯求积公式 Newton-Cotes Quadrature Formula：

- 若函数 $f(x)\approx P(x)$，则有：$\int_a^b f(x)dx\approx\int_a^b P(x)dx$：$$I=\int_a^bL_n(x)\ dx=\int_a^b(\Sigma_{i=0}^n\ a_i(x)f(x_i))\ dx=\Sigma_{i=0}^n\ (\int_a^b\ a_i(x)\ dx)\ f(x_i)=\Sigma_{i=0}^n\ C_if(x_i)$$取 $C_i=\int_a^ba_i(x)\ dx$，这个值只与节点有关，与被积函数的形式无关，这个系数称为“牛顿 - 柯特斯系数”

- $a_i(x)$ 为拉格朗日基函数，等距节点下有：$$t=\frac{x-a}{h},\ \ \ \ h=\frac{b-a}{n}$$$$a_i=\frac{(-1)^{n-i}}{i!(n-i)!}\cdot t\cdot(t-1)\cdots(t-i+1)\cdot(t-i-1)\cdots(t-n)$$所以：$$C_i=\int_a^b a_i\ dx=(b-a)C_i^{(n)}$$$$=(b-a)\cdot\frac{(-1)^{n-i}}{i!(n-i)!}\int_0^n t\cdot(t-1)\cdots(t-i+1)\cdot(t-i-1)\cdots(t-n)\ dt$$得到：$$I=\Sigma_{i=0}^n\ C_if(x_i)=(b-a)\Sigma_{i=0}^n\ C_i^{(n)}f(x_i)$$此式称为“$n$ 阶牛顿 - 柯特斯公式”

- Newton - Cotes 系数表：

| $n$ | $C_0^{(n)}$         | $C_1^{(n)}$          | $C_2^{(n)}$          | $C_3^{(n)}$           | $C_4^{(n)}$           | $C_5^{(n)}$           | $C_6^{(n)}$          | $C_7^{(n)}$          | $C_8^{(n)}$         |
| :-- | :------------------ | :------------------- | :------------------- | :-------------------- | :-------------------- | :-------------------- | :------------------- | -------------------- | ------------------- |
| $1$ | $\frac{1}{2}$       | $\frac{1}{2}$        |                      |                       |                       |                       |                      |                      |                     |
| $2$ | $\frac{1}{6}$       | $\frac{2}{3}$        | $\frac{1}{6}$        |                       |                       |                       |                      |                      |                     |
| $3$ | $\frac{1}{8}$       | $\frac{3}{8}$        | $\frac{3}{8}$        | $\frac{1}{8}$         |                       |                       |                      |                      |                     |
| $4$ | $\frac{7}{90}$      | $\frac{16}{45}$      | $\frac{2}{15}$       | $\frac{16}{45}$       | $\frac{7}{90}$        |                       |                      |                      |                     |
| $5$ | $\frac{19}{288}$    | $\frac{25}{96}$      | $\frac{25}{144}$     | $\frac{25}{144}$      | $\frac{25}{96}$       | $\frac{19}{288}$      |                      |                      |                     |
| $6$ | $\frac{41}{840}$    | $\frac{9}{35}$       | $\frac{9}{280}$      | $\frac{34}{105}$      | $\frac{9}{280}$       | $\frac{9}{35}$        | $\frac{41}{840}$     |                      |                     |
| $7$ | $\frac{751}{17280}$ | $\frac{3577}{17280}$ | $\frac{1323}{17280}$ | $\frac{2989}{17280}$  | $\frac{2989}{17280}$  | $\frac{1323}{17280}$  | $\frac{3577}{17280}$ | $\frac{751}{17280}$  |                     |
| $8$ | $\frac{959}{28350}$ | $\frac{5888}{28350}$ | $\frac{-928}{28350}$ | $\frac{10496}{28350}$ | $\frac{-4540}{28350}$ | $\frac{10496}{28350}$ | $\frac{-928}{28350}$ | $\frac{5888}{28350}$ | $\frac{959}{28350}$ |
可以发现，当 $n=8$ 时系数已经出现负值，牛顿 - 柯特斯公式出现不稳定现象

- 当 $n=1$ 时：$$I(f)\approx\frac{b-a}{2}[f(a)+f(b)]$$这称为“梯形公式 Trapezoid”（积分几何意义，被积区域近似看成梯形）

- 当 $n=2$ 时：$$I(f)\approx\frac{b-a}{6}[f(a)+4f(\frac{a+b}{2})+f(b)]$$这称为“辛卜生公式 Simpson”

- 当 $n=3$ 时：$$I(f)\approx\frac{b-a}{8}[f(x_0)+3f(x_1)+3f(x_2)+f(x_3)]$$这称为“$3/8$ 公式”

- 当 $n=4$ 时：$$I(f)\approx\frac{b-a}{90}[7f(x_0)+32f(x_1)+12f(x_2)+32f(x_3)+7f(x_4)]$$这称为“柯特斯公式 Cotes”


- 例 1：用 $n=6$ 的牛顿 - 柯特斯公式计算定积分值：$$I=\int_0^1\frac{dx}{1+x}$$

- 解法：计算出 $h=\frac{b-a}{n}=\frac{1-0}{6}$ 时在 $x_i=0+\frac{1}{6}i$，$(i=0,1,2,\cdots,6)$ 上的被积函数值 $f(x_i)=\frac{6}{6+i}$，按 $n=6$ 的牛顿 - 柯特斯公式得：$$I=\frac{1-0}{840}[]$$

