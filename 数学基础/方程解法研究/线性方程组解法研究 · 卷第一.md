### 壹  直接解法：

#### 1. 克莱姆法则 Cramer's Rule：

##### 定理 1：

- 如果线性方程组：$$\begin{cases}a_{11}x_1+a_{12}x_2+\cdots+a_{1n}x_n=b_1\\ a_{21}x_1+a_{22}x_2+\cdots+a_{2n}x_n=b_2\\ \cdots\cdots\cdots\cdots\cdots\cdots\cdots\cdots\cdots\cdots\\ a_{n1}x_1+a_{n2}x_2+\cdots+a_{nn}x_n=b_n\end{cases}$$其系数行列式为：$$D=\begin{vmatrix}a_{11}&a_{12}&\cdots&a_{1n}\\ a_{21}&a_{22}&\cdots&a_{2n}\\ \cdots&\cdots&\cdots&\cdots\\ a_{n1}&a_{n2}&\cdots&a_{nn}\end{vmatrix}$$如果 $D\neq0$，那么这个方程组有解，并且是唯一的，这个解可表示成：$$x_1=\frac{D_1}{D},\ x_2=\frac{D_2}{D},\ \cdots,\ x_n=\frac{D_n}{D}$$其中 $D_i$ 是把 $D$ 中第 $i$ 列换成常数项 $b_1,\ b_2, \cdots,\ b_n$ 所得的行列式，即：$$D=\begin{vmatrix}a_{11}&\cdots&a_{1,i-1}&b_{1i}&a_{1,i+1}&\cdots&a_{1n}\\ a_{21}&\cdots&a_{2,i-1}&b_{2i}&a_{1,i+1}&\cdots&a_{2n}\\ \vdots&\vdots&\vdots&\vdots&\vdots&\vdots&\vdots\\ a_{n1}&\cdots&a_{n,i-1}&b_{ni}&a_{n,i+1}&\cdots&a_{nn}\end{vmatrix}_{\ \ \ i=(1,2,\cdots,n)}$$

- 克莱姆法则成立的两个条件：
	- 方程个数 $=$ 未知量个数
	- 系数行列式 $D\neq0$

##### 定理 2：

- 如果齐次线性方程组：$$\begin{cases}a_{11}x_1+a_{12}x_2+a_{13}x_3=0\\ a_{21}x_1+a_{22}x_2+a_{23}x_3=0\\ a_{31}x_1+a_{32}x_2+a_{33}x_3=0\end{cases}$$其方程个数等于未知量个数，并且系数行列式 $D\neq0$，则方程组只有零解（即 $x_1=x_2=x_3=0$）

- 逆否命题：若齐次线性方程组有非零解，则它的系数行列式必等于零

- 拓展充要条件：（方程个数等于未知量个数的）齐次线性方程组有非零解 $\iff$ $D\neq0$

##### 应用例题：

- 例 1：对于下述关于 $x$ 和 $y$ 的二元一次方程组：$$\begin{cases}px+y=2\\ -x+py=-4\end{cases}$$已知 $x>p+2>0$，求参数 $p$ 的取值范围

- 解法：克莱姆法则：$$x=\frac{\begin{vmatrix}2&1\\ -4&p\end{vmatrix}}{\begin{vmatrix}p&1\\ -1&p\end{vmatrix}}=\frac{2p+4}{p^2+1}=\frac{2(p+2)}{p^2+1}$$$$\because x\ \textgreater\ p+2\ \textgreater\ 0\ \ \ \ \Rightarrow\ \ \ \ \frac{2(p+2)}{p^2+1}\textgreater p+2\ \ \ \ \Rightarrow\ \ \ \ p^2+1\ \textless\ 2\ \ \ \ \Rightarrow\ \ \ \ -1\textless\ p \textless\ 1$$由此得 $p$ 的取值范围为 $(-1,1)$


- 例 2：讨论齐次线性方程组：$$\begin{cases}x_1+x_2+x_3=0\\ ax_1+bx_2+cx_3=0\\ a^2x_1+b^2x_2+c^2x_3=0\end{cases}$$求其中参数 $a$，$b$，$c$ 满足什么关系时，该方程组只有零解

- 解法：克莱姆法则：$$D=\begin{vmatrix}1&1&1\\ a&b&c\\ a^2&b^2&c^2\end{vmatrix}$$该行列式为范德蒙德行列式，有：$$D=(b-a)(c-a)(c-b)$$若方程组只有零解，则需要满足：$$D=(b-a)(c-a)(c-b)\neq0$$由此得：只有 $a$，$b$，$c$ 三个参数各不相等时，上述齐次线性方程组只有零解


- 例 3：已知三角方程：$$sin(\theta+30\degree)=\frac{\sqrt{7}}{7}$$其中 $0\degree\textless\theta+30\degree\textless 90\degree$，求 $\cos{\theta}$ 的值

- 解法：将根据正弦方程及角度范围推导余弦方程：$$\cos{(\theta+30\degree)}=\frac{\sqrt{42}}{7}$$根据和差角公式：$$\begin{cases}\frac{\sqrt{3}}{2}\sin{\theta}+\frac{1}{2}\cos{\theta}=\frac{\sqrt{7}}{7}\\ -\frac{1}{2}\sin{\theta}+\frac{\sqrt{3}}{2}\cos{\theta}=\frac{\sqrt{42}}{7}\end{cases}$$根据克莱姆法则：$$\cos{\theta}=\frac{\begin{vmatrix}\frac{\sqrt{3}}{2}&\frac{\sqrt{7}}{7}\\ -\frac{1}{2}&\frac{\sqrt{42}}{7}\end{vmatrix}}{\begin{vmatrix}\frac{\sqrt{3}}{2}&\frac{1}{2}\\ -\frac{1}{2}&\frac{\sqrt{3}}{2}\end{vmatrix}}=\frac{3\sqrt{14}+\sqrt{7}}{14}$$解得最终结果：$\cos{\theta}=\frac{3\sqrt{14}+\sqrt{7}}{14}$



~~~
参考资料：
1. 百度经验《怎样利用克莱姆法则解线性方程组》- 2017-01-14 17:42，https://jingyan.baidu.com/article/915fc414f394e551394b208e.html

2. CSDN — “雏鹰高飞”《线性代数学习笔记（七）——克莱姆法则》- 2020-06-28 23:04:53，https://blog.csdn.net/li2008kui/article/details/107009963?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-1-107009963-blog-90043320.235^v43^pc_blog_bottom_relevance_base1&spm=1001.2101.3001.4242.2&utm_relevant_index=4
~~~


##### 逆矩阵法：

- 对于线性方程组 $AX=B$，若 $\vert A\vert\neq0$，则 $A$ 存在逆矩阵 $A^{-1}$，此时 $X=A^{-1}B$

- 对于矩阵 $A$ 中的每个元素 $A_{ij}$，去掉该元素所在的行和列，剩下的元素构成的子矩阵称为 $A_{ij}$ 的余子式，记为 $M_{ij}$；$A_{ij}$ 的代数余子式 $A_{ij}^*=(-1)^{i+j}M_{ij}$，其中 $i$ 和 $j$ 分别是元素 $A_{ij}$ 的行号和列号；将矩阵 $A$ 的每个元素的代数余子式按照原矩阵的行列互换规则放置在新矩阵的对应位置上，得到伴随矩阵 $A^*$

- 如果矩阵 $A$ 可逆，则逆矩阵：$A^{-1}=\frac{A^*}{\vert A\vert}$


- 例 4：求解下列线性方程组：$$\begin{cases}2x_1+2x_2+3x_3=\alpha\\ x_1-x_2=\beta\\ -x_1+2x_2+x_3=\gamma\end{cases}$$

- 解法：求系数矩阵及其行列式：$$A=\begin{bmatrix}2&2&3\\ 1&-1&0\\ -1&2&1\end{bmatrix},\ \ \ \ \vert A\vert=-1$$其伴随矩阵为：$$A^*=\begin{bmatrix}-1&4&3\\ -1&5&3\\ 1&-6&-4\end{bmatrix}$$故其逆矩阵为：$$A^{-1}=\frac{A^*}{\vert A\vert}=\begin{bmatrix}1&-4&-3\\ 1&-5&-3\\ -1&6&4\end{bmatrix}$$故方程的解向量为：$$X=A^{-1}B=\begin{bmatrix}1&-4&-3\\ 1&-5&-3\\ -1&6&4\end{bmatrix}\begin{bmatrix}\alpha\\ \beta\\ \gamma\end{bmatrix}=\begin{bmatrix}\alpha-4\beta-3\gamma\\ \alpha-5\beta-3\gamma\\ -\alpha+6\beta+4\gamma\end{bmatrix}$$由此得线性方程组的解为：$$\begin{cases}x_1=\alpha-4\beta-3\gamma\\ x_2=\alpha-5\beta-3\gamma\\ x_3=-\alpha+6\beta+4\gamma\end{cases}$$


#### 2. 消元法：

##### 消元法的思想：

将线性方程组：$$\begin{cases}a_{11}x_1+a_{12}x_2+a_{13}x_3=b_1\\ a_{21}x_1+a_{22}x_2+a_{23}x_3=b_2\\ a_{31}x_1+a_{32}x_2+a_{33}x_3=b_3\end{cases}$$消元化为：$$\begin{cases}u_{11}x_1+u_{12}x_2+u_{13}x_3=z_1\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u_{22}x_2+u_{23}x_3=z_2\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u_{33}x_3=z_3\end{cases}$$逐层回代解得：$$\begin{cases}x_1=\alpha\\ x_2=\beta\\ x_3=\gamma\end{cases}$$这一过程是消元法的核心思想

##### 加减消元法：

- 对于线性方程组：$$\begin{cases}a_{11}x_1+a_{12}x_2=b_1\\ a_{21}x_1+a_{22}x_2=b_2\end{cases}$$将一个方程的 $\lambda$ 倍加到另一个方程上，得到同构方程，目的是消除一个变量：$$(\lambda a_{11}+a_{21})x_1+(\lambda a_{12}+a_{22})x_2=\lambda b_1+b_2$$令 $\lambda a_{11}+a_{21}=0$ 可以消去 $x_1$，同理令 $\lambda a_{12}+a_{22}=0$ 可以消去 $x_2$，以此解出另一个变量值


- 例 1：解二元一次方程组：$$\begin{cases}4x+y=5\\ 2y-x=1\end{cases}$$

- 解法：将第 $2$ 个式子的 $\lambda$ 倍加到第一个式子上，得到同构方程：$$(4-\lambda)x+(2\lambda+1)y=5+\lambda$$为了消除变量 $x$，$\lambda$ 取 $4$，得到：$$9y=9\Rightarrow y=1$$同理，为了消除变量 $y$，$\lambda$ 取 $-\frac{1}{2}$，得到：$$\frac{9}{2}x=\frac{9}{2}\Rightarrow x=1$$综上，方程的解为：$$\begin{cases}x=1\\ y=1\end{cases}$$


- 对于线性方程组：$$\begin{cases}a_{11}x_1+a_{12}x_2+a_{13}x_3=b_1\\ a_{21}x_1+a_{22}x_2+a_{23}x_3=b_2\\ a_{31}x_1+a_{32}x_2+a_{33}x_3=b_3\end{cases}$$可以考虑将一个式子的 $\lambda$ 倍和另一个式子的 $\mu$ 倍加到第三个式子上，以消除两个变量：$$(\lambda a_{11}+\mu a_{21}+a_{31})x_1+(\lambda a_{12}+\mu a_{22}+a_{32})x_2+(\lambda a_{13}+\mu a_{23}+a_{33})x_3=\lambda b_1+\mu b_2+b_3$$在同构方程中同时取：$$\begin{cases}\lambda a_{11}+\mu a_{21}=-a_{31}\\ \lambda a_{12}+\mu a_{22}=-a_{32}\end{cases}$$解出 $\lambda$ 和 $\mu$ 值代入上式，即可求出 $x_3$


- 例 2：用加减消元法解线性方程组：$$\begin{cases}-23x_1+11x_2+x_3=0\\ 11x_1-3x_2-2x_3=3\\ x_1-2x_2+2x_3=-1\end{cases}$$将第 $2$ 个方程的 $\lambda$ 倍和第 $3$ 个方程的 $\mu$ 倍加到第 $1$ 个方程上，得到同构方程：$$(11\lambda+\mu-23)x_1+(11-3\lambda-2\mu)x_2+(-2\lambda+2\mu+1)x_3=3\lambda-\mu$$为了消除 $x_1$ 与 $x_2$，取：$$\begin{cases}11\lambda+\mu=23\\ 3\lambda+2\mu=11\end{cases}$$解得：$$\lambda=\frac{\begin{vmatrix}23&1\\ 11&2\end{vmatrix}}{\begin{vmatrix}11&1\\ 3&2\end{vmatrix}}=\frac{35}{19},\ \ \ \ \mu=\frac{\begin{vmatrix}11&23\\ 3&11\end{vmatrix}}{\begin{vmatrix}11&1\\ 3&2\end{vmatrix}}=\frac{52}{19}$$代回同构方程得：$$\frac{53}{19}x_3=\frac{53}{19}\Rightarrow x_3=1$$为了消除 $x_1$ 与 $x_3$，取：$$\begin{cases}11\lambda+\mu=23\\ -2\lambda+2\mu=-1\end{cases}$$解得：$$\lambda=\frac{\begin{vmatrix}23&1\\ -1&2\end{vmatrix}}{\begin{vmatrix}11&1\\ -2&2\end{vmatrix}}=\frac{47}{24},\ \ \ \ \mu=\frac{\begin{vmatrix}11&23\\ -2&-1\end{vmatrix}}{\begin{vmatrix}11&1\\ -2&2\end{vmatrix}}=\frac{35}{24}$$代回同构方程得：$$\frac{53}{24}x_2=\frac{53}{12}\Rightarrow x_2=2$$为了消除 $x_2$ 与 $x_3$，取：$$\begin{cases}3\lambda+2\mu=11\\ -2\lambda+2\mu=-1\end{cases}$$解得：$$\lambda=\frac{\begin{vmatrix}11&2\\ -1&2\end{vmatrix}}{\begin{vmatrix}3&2\\ -2&2\end{vmatrix}}=2.4,\ \ \ \ \mu=\frac{\begin{vmatrix}3&11\\ -2&-1\end{vmatrix}}{\begin{vmatrix}3&2\\ -2&2\end{vmatrix}}=1.9$$代回同构方程得：$$5.3x_1=5.3\Rightarrow x_1=1$$综上，该方程的解为：$$\begin{cases}x_1=1\\ x_2=2\\ x_3=1\end{cases}$$


##### 高斯消元法 Gaussian Elimination：

- 对于线性方程组：$$\begin{cases}a_{11}x_1+a_{12}x_2+a_{13}x_3=b_1\ \text{(I)}\\ a_{21}x_1+a_{22}x_2+a_{23}x_3=b_2\ \text{(II)}\\ a_{31}x_1+a_{32}x_2+a_{33}x_3=b_3\ \text{(III)}\end{cases}$$用 $\text{(I)}$ 式除以 $l_{11}$：$$\frac{a_{11}}{l_{11}}x_1+\frac{a_{12}}{l_{11}}x_1+\frac{a_{13}}{l_{13}}x_3=\frac{b_1}{l_{11}}$$即：$$u_{11}x_1+u_{12}x_2+u_{13}x_3=z_1$$再乘以 $\frac{a_{21}}{u_{11}}$：$$a_{21}x_1+u_{12}\frac{a_{21}}{u_{11}}x_2+u_{13}\frac{a_{21}}{u_{11}}x_3=\frac{a_{21}}{u_{11}}z_1$$令 $\frac{a_{21}}{u_{11}}=l_{21}$，则：$$a_{21}x_1+u_{12}l_{21}x_2+u_{13}l_{21}x_3=l_{21}z_1\ \text{(IV)}$$$\text{(II)}$ 式减去 $\text{(IV)}$ 式：$$(a_{22}-l_{21}u_{12})x_2+(a_{23}-l_{21}u_{13})x_3=b_2-l_{21}z_1$$再除以 $l_{22}$：$$\frac{(a_{22}-l_{21}u_{12})}{l_{22}}x_2+\frac{(a_{23}-l_{21}u_{13})}{l_{22}}x_3=\frac{b_2-l_{21}z_1}{l_{22}}$$得到：$$u_{22}x_2+u_{23}x_3=z_2\ \text{(V)}$$同理借助 $\text{(III)}$ 式有：$$(a_{32}-l_{31}u_{12})x_2+(a_{33}-l_{31}u_{13})x_3=b_3-l_{31}z_1\ \text{(VI)}$$根据 $\text{(V)}$ 式，还有：$$\frac{a_{32}-l_{31}u_{12}}{u_{22}}(u_{22}x_2+u_{23}x_3)=\frac{a_{32}-l_{31}u_{12}}{u_{22}}z_2$$令 $\frac{a_{32}-l_{31}u_{12}}{u_{22}}=l_{32}$，则：$$(a_{32}-l_{31}u_{12})x_2+l_{32}u_{23}x_3=l_{32}z_2\ \text{(VII)}$$用 $\text{(VI)}$ 式减去 $\text{(VII)}$ 式：$$(a_{33}-l_{31}u_{13}-l_{32}u_{23})x_3=b_3-l_{31}z_1-l_{32}z_2$$令 $u_{33}=a_{33}-l_{31}u_{13}-l_{32}u_{23}$，$z_3=b_3-l_{31}z_1-l_{32}z_2$，得到：$$u_{33}x_3=z_3$$

- 通过上述变换，可以将原线性方程组化成如下形式：$$\begin{cases}u_{11}x_1+u_{12}x_2+u_{13}x_3=z_1\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u_{22}x_2+u_{23}x_3=z_2\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ u_{33}x_3=z_3\end{cases}\ \text{(VIII)}$$简记为：$$UX=Z$$其中：$$\begin{cases}l_{11}z_1=b_1\\ l_{21}z_1+l_{22}z_2=b_2\\ l_{31}z_1+l_{32}z_2+l_{33}z_3=b_3\end{cases}$$即：$$z_1=\frac{b_1}{l_{11}},\ \ z_2=\frac{b_2-l_{21}z_1}{l_{22}},\ \ z_3=\frac{b_3-l_{31}z_1-l_{32}z_2}{l_{33}}$$简记为：$$LZ=B$$因此可得：$$LUX=B$$又因：$$AX=B$$故可得：$$A=LU$$

- 上述 $\text{(VIII)}$ 式可解得：$$x_i=\frac{z_i-\Sigma_{k=i+1}^n\ u_{ik}\cdot x_k}{u_{ii}},\ (i=n,n-1,\cdots,2,1)$$其中：$$l_{ij}=\frac{a_{ij}-\Sigma_{k=1}^{j-1}\ l_{ik}\cdot u_{kj}}{u_{jj}},\ i\geq j$$$$u_{ij}=\frac{a_{ij}-\Sigma_{k=1}^{i-1}\ l_{ik}\cdot u_{kj}}{l_{ii}},\ i\leq j$$$$z_i=\frac{b_i-\Sigma_{k=1}^{i-1}\ l_{ik}\cdot z_k}{l_{ii}}x_i=\frac{z_i-\Sigma_{k=i+1}^{n}\ u_{ik}\cdot x_k}{u_{ii}},\ (i=n,n-1,\cdots,2,1)$$

- 将矩阵 $A$ 拆解成下三角矩阵 $L$ 和上三角矩阵 $U$ 的乘积的过程称为“三角分解 Trigonometric Decomposition”

- 高斯消元法 Gaussian Emilination 在求上述各项 $l$、$u$、$z$ 时，取 $L$ 矩阵对角元素 $l_{ii}=1$，其中 $i=1,2,\cdots,n$

- 在矩阵分解时取 $L$ 矩阵对角元素为 $1$ 的方法又称“杜利特尔分解 Doolittle Decomposition”

- 高斯消元法的实质：用第 $1$ 个方程消去第 $2$、$3$ 个方程的 $x_1$ 项，用第 $2$ 各方程消去第 $3$ 个方程的 $x_2$ 项，从而将方程组化为“上三角”阶梯状


- 例 3：用高斯消元法解线性方程组：$$\begin{cases}-23x_1+11x_2+x_3=0\\ 11x_1-3x_2-2x_3=3\\ x_1-2x_2+2x_3=-1\end{cases}$$

- 解法：首先取：$$l_{11}=1,\ \ l_{22}=1,\ \ l_{33}=1$$由此可解：$$u_{11}=\frac{a_{11}-0}{l_{11}}=-23,\ \ \ \ u_{12}=\frac{a_{12}-0}{l_{11}}=11,\ \ \ \ u_{13}=\frac{a_{13}-0}{l_{11}}=1$$$$l_{21}=\frac{a_{21}-0}{u_{11}}=-\frac{11}{23}=-0.47826,\ \ \ \ l_{31}=\frac{a_{31}-0}{u_{11}}=-\frac{1}{23}=-0.04348$$$$u_{22}=\frac{a_{22}-l_{21}u_{12}}{l_{22}}=2.26086,\ \ \ \ u_{23}=\frac{a_{23}-l_{21}u_{13}}{l_{22}}=-1.52174$$$$l_{32}=\frac{a_{32}-l_{31}u_{12}}{u_{22}}=-0.67307$$$$u_{33}=\frac{a_{33}-l_{31}u_{13}-l_{32}u_{23}}{l_{33}}=1.01924$$由此得：$$z_1=\frac{b_1}{l_{11}}=0,\ \ \ \ z_2=\frac{b_2-l_{21}z_1}{l_{22}}=3,\ \ \ \ z_3=\frac{b_3-l_{31}z_1-l_{32}z_2}{l_{33}}=1.01921$$进而解得：$$x_3=\frac{z_3}{u_{33}}=0.99997,\ \ \ \ x_2=\frac{z_2-u_{23}x_3}{u_{22}}=1.99999,\ \ \ \ x_1=\frac{z_1-u_{13}x_3-u_{12}x_2}{u_{11}}=0.99999$$将结果四舍五入得到：$$x_1=1,\ \ \ \ x_2=2,\ \ \ \ x_3=1$$回代检验——成立！最终线性方程组的解为：$$\begin{cases}x_1=1\\ x_2=2\\ x_3=1\end{cases}$$


##### 克劳特分解 Crout Decomposition：

- 克劳特消元法在消元法基本思想求各项 $l$、$u$、$z$ 时，取 $U$ 矩阵对角元素 $u_{ii}=1$，其中 $i=1,2,\cdots,n$


- 例 4：求解线性方程组的解：$$\begin{cases}2x_1+3x_2+4x_3=6\\ 3x_1+5x_2+2x_3=5\\ 4x_1+3x_2+30x_3=32\end{cases}$$

- 解法：首先取：$$u_{11}=1,\ \ \ \ u_{22}=1,\ \ \ \ u_{33}=1$$由此可解：$$l_{11}=\frac{a_{11}-0}{u_{11}}=2,\ \ \ \ l_{12}=\frac{a_{12}-0}{u_{11}}=3,\ \ \ \ l_{13}=\frac{a_{13}-0}{u_{11}}=4$$$$u_{12}=\frac{a_{12}-0}{l_{11}}=1.5,\ \ \ \ u_{13}=\frac{a_{13}-0}{l_{11}}=2$$$$l_{22}=\frac{a_{22}-l_{21}u_{12}}{u_{22}}=0.5$$$$u_{23}=\frac{a_{23}-l_{21}u_{13}}{l_{22}}=-8$$$$l_{32}=\frac{a_{32}-l_{31}u_{12}}{u_{22}}=-3,\ \ \ \ l_{33}=\frac{a_{33}-l_{31}u_{13}-l_{32}u_{23}}{u_{33}}=-2$$由此得：$$z_1=\frac{b_1}{l_{11}}=3,\ \ \ \ z_2=\frac{b_2-l_{21}z_1}{l_{22}}=-8,\ \ \ \ z_3=\frac{b_3-l_{31}z_1-l_{32}z_2}{l_{33}}=2$$进而解得：$$x_3=\frac{z_3}{u_{33}}=2,\ \ \ \ x_2=\frac{z_2-u_{23}x_3}{u_{22}}=8,\ \ \ \ x_1=\frac{z_1-u_{13}x_3-u_{12}x_2}{u_{11}}=-13$$即：$$\begin{cases}x_1=-13\\ x_2=8\\ x_3=2\end{cases}$$


- 克劳特消元法的实质是将方程组化为阶梯状后，再将首元系数置为 $1$：$$\begin{cases}x_1+u_{12}x_2+u_{13}x_3=z_1\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_2+u_{23}x_3=z_2\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_3=z_3\end{cases}$$

- 在克劳特消元的基础上，可以进一步消元，将方程组化为如下形式：$$\begin{cases}x_1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =\alpha\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_2\ \ \ \ \ \ \ \ \ \ \ \ \ \ =\beta\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_3=\gamma\end{cases}$$这种方法又称为“高斯 - 约当消元法 Gauss-Jordan Elimination”

- 使用高斯 - 约当消元法解仅有唯一解的线性方程组时，一定能将方程组化为上述形式，其理论基础为：$n$ 阶满秩方阵一定可以通过有限次初等行变换得到一个 $n$ 阶单位矩阵

- 高斯 - 约当消元法的优点在于无需迭代，结果精度更高

##### 平方根法 Square Root Method（乔莱斯基分解 Cholesky Decomposition）：

- 平方根法适用于系数矩阵为对称矩阵的线性方程组，取 $L$ 矩阵和 $U$ 矩阵的对角元素 $l_{ii}=u_{ii}$，其中 $i=1,2,\cdots,n$

- 此时有：$$l_{ii}=\frac{a_{ii}-\Sigma_{k=1}^{i-1}\ l_{ik}^2}{l_{ii}}=\sqrt{a_{ii}-\Sigma_{k=1}^{i-1}\ l_{ik}^2}$$$$u_{ij}=l_{ji}$$

- 乔莱斯基分解 Cholesky Decomposition 的实质是将对称正定矩阵 $A$ 表示成下三角矩阵 $L$ 和其转置乘积的分解：$$A=LL^T$$


- 例 5：求解线性方程组的解：$$\begin{cases}x_1+0.42x_2+0.54x_3=0.3\\ 0.42x_1+x_2+0.32x_3=0.5\\ 0.54x_1+0.32x_2+x_3=0.7\end{cases}$$

- 解法：观察到系数矩阵为对称矩阵，采用平方根法，首先取：$$l_{11}=u_{11}=\sqrt{a_{11}}=1$$$$l_{21}=\frac{a_{21}-0}{u_{11}}=0.42,\ \ \ \ l_{31}=\frac{a_{31}-0}{u_{11}}=0.54$$$$u_{12}=l_{21}=0.42,\ \ \ \ u_{13}=l_{31}=0.54$$$$l_{22}=\sqrt{a_{22}-l_{21}^2}=\sqrt{1-0.42^2}=0.90752,\ \ \ \ u_{22}=l_{22}=0.90752$$$$l_{32}=\frac{a_{32}-l_{31}u_{12}}{u_{22}}=0.10270,\ \ \ \ u_{23}=l_{32}=0.10270$$$$u_{33}=l_{33}=\sqrt{a_{33}-l_{31}^2-l_{32}^2}=0.83537$$由此得：$$z_3=\frac{b_3-l_{31}z_1-l_{32}z_2}{l_{33}}=0.59336,\ \ \ \ z_2=\frac{b_2-l_{21}z_1}{l_{22}}=0.41211,\ \ \ \ z_1=\frac{b_1-0}{l_{11}}=0.3$$因此：$$x_3=\frac{z_3}{u_{33}}=0.71030,\ \ \ \ x_2=\frac{z_2-u_{23}x_3}{u_{22}}=0.37372,\ \ \ \ x_1=\frac{z_1-u_{12}x_2-u_{13}x_3}{u_{11}}=-0.24052$$即：$$\begin{cases}x_1=-0.24052\\ x_2=0.37372\\ x_3=0.71030\end{cases}$$


- 当出现 $l_{ii}\textless0$ 情况时，$l_{ii}$ 为虚数，此时要按复数运算规则进行计算


##### 追赶法：

- 追赶法适用于三对角线形的线性方程组：$$\begin{cases}b_1x_1+c_1x_2=d_1\\ a_2x_1+b_2x_2+c_2x_3=d_2\\ \ \ \ \ \ \ \ \ \ \ \ \ \ a_3x_2+b_3x_2+c_3x_3=d_3\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ddots\ \ \ \ \ \ \ddots\ \ \ \ \ \ \ddots\ \ \ \ \ \ddots\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a_{n-1}x_{n-2}+b_{n-1}x_{n-1}+c_{n-1}x_n=d_{n-1}\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a_nx_{n-1}+b_nx_n=d_n\end{cases}$$将其克劳特分解，得到：$$\begin{cases}l_{i,i-1}=a_i,\ \ \ \ (i=2,3,\cdots,n)\\ l_{ii}=b_i-a_i\cdot u_{i-1,i},\ \ \ \ (i=1,2,\cdots,n;\ a_1=u_{01}=0)\\ u_{i,i+1}=\frac{c_i}{l_{ii}},\ \ \ \ (i=1,2,\cdots,n-1)\end{cases}$$（“追赶法”：消元过程为“追”，迭代过程为“赶”）通过 $LZ=B$ 得：$$z_i=\frac{d_i-a_iz_{i-1}}{l_{ii}},\ \ \ \ (i=1,2,\cdots,n;\ z_0=a_1=0)$$再 $UX=Z$ 得：$$x_i=z_i-u_{i,i-1}\cdot x_{x+1},\ \ \ \ (i=n,n-1,\cdots,2,1)$$


- 例 6：用追赶法求解线性方程组的解：$$\begin{cases}-2x_1+x_2\ \ \ \ \ =-2\\ x_1-2x_2+x_3=1\\ \ \ \ \ \ \ \ \ \ x_2-2x_3=-4\end{cases}$$

- 解法：由克劳特消元法知：$$u_{11}=u_{22}=u_{33}=1$$$$l_{11}=\frac{a_{11}-0}{u_{11}}=-2,\ \ \ \ l_{21}=\frac{a_{21}-0}{u_{11}}=-1.5$$$$u_{23}=\frac{a_{23}-l_{21}u_{13}}{l_{22}}=-0.66667$$$$l_{32}=\frac{a_{32}-l_{31}u_{12}}{u_{22]}}=1,\ \ \ \ l_{33}=\frac{a_{33}-l_{31}u_{13}-l_{32}u_{23}}{u_{33}}=1.33333$$列 $LZ=B$：$$\begin{cases}-2z_1\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =-2\\ \ \ \ \ \ z_1-1.5z_2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =1\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ z_2-1.33333z_3=-4\end{cases}$$列 $UX=Z$：$$\begin{cases}x_1-0.5x_2\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ =1\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_2-0.66667x_3=0\\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ x_3=3.00001\end{cases}$$由此解得：$$\begin{cases}x_3=3.00001\\ x_2=2.00002\\ x_1=2.00001\end{cases}$$进而得方程组精准解：$$\begin{cases}x_1=2\\ x_2=2\\ x_3=3\end{cases}$$


##### 消元法的应用条件：

- 消元法的应用条件为：$$l_{ii}\neq0\ 且\ u_{ii}\neq0,\ \ \ \ (i=1,2,\cdots,n)$$

- 定理 1：矩阵 $A$ 的各阶主子式均不为零，即：$$\begin{vmatrix}A_1\end{vmatrix}=\begin{vmatrix}a_1\end{vmatrix}\neq0,\ \ \begin{vmatrix}A_2\end{vmatrix}=\begin{vmatrix}a_{11}&a_{12}\\ a_{21}&a_{22}\end{vmatrix}\neq0,\ \ \begin{vmatrix}A_3\end{vmatrix}=\begin{vmatrix}a_{11}&a_{12}&a_{13}\\ a_{21}&a_{22}&a_{23}\\ a_{31}&a_{32}&a_{33}\end{vmatrix}\neq0,\ \ \cdots,\ \ \begin{vmatrix}A_n\end{vmatrix}=\begin{vmatrix}A\end{vmatrix}\neq0$$则一定有：$l_{ii}\neq0$ 且 $u_{ii}\neq0$，$(i=1,2,\cdots,n)$

- 定理 2：$A$ 为实对称正定矩阵 $\Leftrightarrow$ $\begin{vmatrix}A_1\end{vmatrix}\textgreater0,\ \ \begin{vmatrix}A_2\end{vmatrix}\textgreater0,\cdots,\begin{vmatrix}A_n\end{vmatrix}\textgreater0$，即 $l_{ii}\neq0$ 且 $u_{ii}\neq0$，$(i=1,2,\cdots,n)$

- 定理 3：$A$ 为严格对角占优矩阵，即 $\vert a_{ii}\vert\textgreater\Sigma_{j=1,\ j\neq i}^{n}\vert a_{ij}\vert,\ (i=1,2,\cdots,n)$，则有：$l_{ii}\neq0$ 且 $u_{ii}\neq0$

##### 列主元素法：

- 顺序消元法的缺点：
	- 消元过程中若出现 $u_{kk}=a_{kk}^{(k-1)}=0$ 的情况，则计算中断；若 $u_{kk}\neq0$，但其值过小，就会使乘数 $\vert l_{ik}\vert\gg1$ 而导致舍入误差严重扩大
	- 主元素法可以有效解决这一问题
	- 最常用和最有效的主元素法有列主元素法和全主元素法

- 主元素法能降低约束条件的强度

- 列主元素法：在消元计算中为使舍入误差减小，就应使乘数 $\vert l_{ik}\vert$ 值尽量地小，即应在 $k$ 列元素中选取绝对值最大的元素作为新的 $u_{kk}$ 值，这个绝对值最大的元素称为主元素，其方法核心为行交换原则


- 例 7：求解线性方程组：$$\begin{cases}10x_1-19x_2-2x_3=3\\ -20x_1+40x_2+x_3=4\\ x_1+4x_2+5x_3=5\end{cases}$$

- 解法：从第一列系数中选出绝对值最大的元素 $-20$ 作为该列的主元素，则交换第一、二行：$$\begin{cases}-20x_1+40x_2+x_3=4\\ 10x_1-19x_2-2x_3=3\\ x_1+4x_2+5x_3=5\end{cases}$$令 $l_{11}=l_{22}=l_{33}=1$，则：$$u_{11}=\frac{a_{11}-0}{l_{11}}=-20$$$$l_{21}=\frac{a_{21}-0}{u_{11}}=-0.5,\ \ \ \ l_{31}=\frac{a_{31}-0}{u_{11}}=-0.05$$用第一行消掉第二行和第三行的 $x_1$ 项：$$\begin{cases}0+x_2-1.5x_3=5\\ 0+6x_2+5.05x_3=5.2\end{cases}$$再选第二列主元素 $6$：$$\begin{cases}6x_2+5.05x_3=5.2\\ x_2-1.5x_3=5\end{cases}$$再用第二行消掉第三行的 $x_2$ 项：$$0-2.34168x_3=4.13332$$进而得：$$\begin{cases}-20x_1+40x_2+x_3=4\\ 6x_2+5.05x_3=5.2\\ -2.34168x_3=4.13332\end{cases}$$逐次回代得：$$\begin{cases}x_1=4.41624\\ x_2=2.35230\\ x_3=-1.76511\end{cases}$$


##### 全主元素法：

- 全主元素法是在全体待选的系数中选取主元素


- 例 8：求解线性方程组：$$\begin{cases}10x_1-19x_2-2x_3=3\\ -20x_1+40x_2+x_3=4\\ x_1+4x_2+5x_3=5\end{cases}$$

- 解法：寻找到所有系数中绝对值最大的 $40$，将其置于主元素位置：$$\begin{cases}40x_2-20x_1+x_3=4\\ -19x_2+10x_1-2x_3=3\\ 4x_2+x_1+5x_3=5\end{cases}$$计算乘数：$$l_{21}=-\frac{19}{40}=-0.475,\ \ \ \ l_{31}=\frac{4}{40}=0.1$$消去 $x_2$：$$\begin{cases}0+0,5x_1-1.525x_3=4.9\\ 0+3x_1+4.9x_3=4.6\end{cases}$$再次选择系数 $4.9$ 置于主元素位置：$$\begin{cases}4.9x_3+3x_1=4.6\\ -1.525x_3+0.5x_1=4.9\end{cases}$$$$l_{32}=-\frac{1.525}{4.9}=-0.31122$$消元：$$1.43366x_1=6.33161$$合并得：$$\begin{cases}40x_2-20x_1+x_3=4\\ 4.9x_3+3x_1=4.6\\ 1.43366x_1=6.3316\end{cases}$$逐次回代得方程解：$$\begin{cases}x_1=4.41640\\ x_2=2.35233\\ x_3=-1.76514\end{cases}$$


- 主元素法可以在消元过程中减小舍入误差，减小除法运算的误差，具有良好的数值稳定性

- 全主元素法在降误差上比列主元素法更优，但列主元素法操作更简单，故大多选用后者

- 结果精度的检验：
	- 1. 残差法：带入近似解 $\widetilde{x}$，则残差 $r=B-A\widetilde{x}$
	- 2. 类比法：任取一向量 $Z$，计算出 $AZ$，记为 $\overline{B}$，再令 $A\overline{X}=\overline{B}$，解出 $\overline{X}$ 与 $Z$ 比较一致位数


### 贰  迭代解法

#### 1. 简单迭代法：

##### 迭代法的的原理：

- 对线性方程组 $Ax=b$ 用等价方程 $x=Bx+f$ 建立迭代格式 $x^{(k+1)}=Bx^{(k)}+f$，$(k=0,1,\cdots)$ 逐步求解的方法叫迭代法

- 记方程组的解为 $x^*$，若 $\lim_{k\to+\infty} x^{(k)}=x^*$，则称迭代法收敛，否则称此迭代法发散

- 迭代法的建立：考虑 $Ax=b$，将其化为 $x=Bx+f$ 的格式（矩阵 $B$ 不唯一），对应写出：$$x^{(k+1)}=Bx^{(k)}+f,\ \ \ \ (k=0,1,\cdots)$$取定初始向量 $x^{(0)}$，则将产生向量序列 $x^{(1)},x^{(2)},\cdots,x^{(k)},x^{(k+1)},\cdots$，若收敛则记 $\lim_{k\to+\infty} x^{(k)}=x^*$，则上式两端取极限有：$$x^*=Bx^*+f$$这种迭代方式也称一阶定常迭代

- 注意上式中迭代矩阵 $B$ 不唯一，且影响迭代的收敛性


##### 简单迭代法：

- 将线性方程组 $AX=B$ 写成 $X=\Phi(X)$ 形式，有两种常见迭代格式，其一如下，其二为雅可比迭代法

- 将 $AX=B$ 化为 $X=(I-A)X+B=CX+B$ 形式，其迭代矩阵为：$$C=\begin{bmatrix}1-a_{11}&-a_{12}&-a_{13}&\cdots&-a_{1n}\\ -a_{21}&1-a_{22}&-a_{23}&\cdots&-a_{2n}\\ \cdots&\cdots&\cdots&&\cdots\\ -a_{n1}&-a_{n2}&-a_{n3}&\cdots&1-a_{nn}\end{bmatrix}=I-A$$其迭代公式为：$$X^{(k+1)}=CX^{(k)}+B$$迭代初值 $X^{(0)}$ 需要自选


- 例 1：若使用简单迭代法求解线性方程组：$$\begin{cases}0.3x_1-0.2x_2+0.1x_3=2\\ -0.1x_1+0.5x_2-0.1x_3=4\\ 0.1x_1-0.1x_2+0.4x_3=3\end{cases}$$求前三次迭代结果

- 解法：取迭代矩阵 $C=I-A$：$$C=\begin{bmatrix}0.7&0.2&-0.1\\ 0.1&0.5&0.1\\ -0.1&0.1&0.6\end{bmatrix}$$迭代公式为：$$\begin{cases}x_1^{(k+1)}=0.7x_1^{(k)}+0.2x_2^{(k)}-0.1x_3^{(k)}+2\\ x_2^{(k+1)}=0.1x_1^{(k)}+0.5x_2^{(k)}+0.1x_3^{(k)}+4\\ x_3^{(k+1)}=-0.1x_1^{(k)}+0.1x_2^{(k)}+0.6x_3^{(k)}+3\end{cases}$$取迭代初值为：$$X^{(0)}=\begin{bmatrix}1\\ 1\\ 1\end{bmatrix}$$迭代 $3$ 次：$$X^{(1)}=\begin{bmatrix}2.8\\ 4.7\\ 3.6\end{bmatrix},\ \ \ \ X^{(2)}=\begin{bmatrix}4.54\\ 6.99\\ 5.35\end{bmatrix},\ \ \ \ X^{(3)}=\begin{bmatrix}6.041\\ 8.484\\ 6.455\end{bmatrix}$$

- 上述题目编程迭代结果如下：
~~~
第1次迭代：x1:2.8  x2:4.7  x3:3.6
第2次迭代：x1:4.54  x2:6.99  x3:5.35
第3次迭代：x1:6.041  x2:8.484  x3:6.455
第4次迭代：x1:7.28  x2:9.4916  x3:7.1173
第5次迭代：x1:8.28259  x2:10.1855  x3:7.49154
第6次迭代：x1:9.08577  x2:10.6702  x3:7.68522
第7次迭代：x1:9.72555  x2:11.0122  x3:7.76957
第8次迭代：x1:10.2334  x2:11.2556  x3:7.79041
第9次迭代：x1:10.6354  x2:11.4302  x3:7.77647
第10次迭代：x1:10.9532  x2:11.5563  x3:7.74536
第11次迭代：x1:11.204  x2:11.648  x3:7.70752
第12次迭代：x1:11.4016  x2:11.7151  x3:7.66892
第13次迭代：x1:11.5573  x2:11.7646  x3:7.6327
第14次迭代：x1:11.6797  x2:11.8013  x3:7.60036
第15次迭代：x1:11.776  x2:11.8287  x3:7.57237
第16次迭代：x1:11.8517  x2:11.8492  x3:7.54868
第17次迭代：x1:11.9112  x2:11.8646  x3:7.52896
第18次迭代：x1:11.9579  x2:11.8763  x3:7.51272
第19次迭代：x1:11.9945  x2:11.8852  x3:7.49948
第20次迭代：x1:12.0232  x2:11.892  x3:7.48876
第21次迭代：x1:12.0458  x2:11.8972  x3:7.48013
第22次迭代：x1:12.0635  x2:11.9012  x3:7.47322
第23次迭代：x1:12.0774  x2:11.9043  x3:7.4677
第24次迭代：x1:12.0882  x2:11.9066  x3:7.46331
第25次迭代：x1:12.0968  x2:11.9085  x3:7.45983
第26次迭代：x1:12.1034  x2:11.9099  x3:7.45707
第27次迭代：x1:12.1087  x2:11.911  x3:7.45489
第28次迭代：x1:12.1128  x2:11.9119  x3:7.45316
第29次迭代：x1:12.116  x2:11.9125  x3:7.4518
第30次迭代：x1:12.1185  x2:11.913  x3:7.45073
第31次迭代：x1:12.1205  x2:11.9134  x3:7.44989
第32次迭代：x1:12.1221  x2:11.9138  x3:7.44923
第33次迭代：x1:12.1233  x2:11.914  x3:7.44871
第34次迭代：x1:12.1242  x2:11.9142  x3:7.4483
第35次迭代：x1:12.125  x2:11.9144  x3:7.44798
第36次迭代：x1:12.1255  x2:11.9145  x3:7.44773
第37次迭代：x1:12.126  x2:11.9146  x3:7.44753
第38次迭代：x1:12.1264  x2:11.9146  x3:7.44737
第39次迭代：x1:12.1266  x2:11.9147  x3:7.44725
第40次迭代：x1:12.1269  x2:11.9147  x3:7.44716
第41次迭代：x1:12.127  x2:11.9148  x3:7.44708
第42次迭代：x1:12.1272  x2:11.9148  x3:7.44702
第43次迭代：x1:12.1273  x2:11.9148  x3:7.44698
第44次迭代：x1:12.1274  x2:11.9148  x3:7.44694
第45次迭代：x1:12.1274  x2:11.9148  x3:7.44691
第46次迭代：x1:12.1275  x2:11.9149  x3:7.44689
第47次迭代：x1:12.1275  x2:11.9149  x3:7.44687
第48次迭代：x1:12.1275  x2:11.9149  x3:7.44686
第49次迭代：x1:12.1276  x2:11.9149  x3:7.44685
第50次迭代：x1:12.1276  x2:11.9149  x3:7.44684
第51次迭代：x1:12.1276  x2:11.9149  x3:7.44683
第52次迭代：x1:12.1276  x2:11.9149  x3:7.44683
第53次迭代：x1:12.1276  x2:11.9149  x3:7.44682
第54次迭代：x1:12.1276  x2:11.9149  x3:7.44682
第55次迭代：x1:12.1276  x2:11.9149  x3:7.44682
第56次迭代：x1:12.1276  x2:11.9149  x3:7.44682
第57次迭代：x1:12.1276  x2:11.9149  x3:7.44681
第58次迭代：x1:12.1276  x2:11.9149  x3:7.44681
第59次迭代：x1:12.1277  x2:11.9149  x3:7.44681
第60次迭代：x1:12.1277  x2:11.9149  x3:7.44681
~~~


##### 简单迭代法的收敛性：

- 对于 $X=MX+N$ 形式的迭代，其迭代公式为 $X^{(k+1)}=MX^{(k)}+N$，$(k=0,1,2,\cdots)$，其向量序列 $\{x^{(k)}\}$ 收敛的充分必要条件为：$$\rho(M)\textless1,\ \ \ \ (\rho(M)为M的谱半径)$$迭代的收敛性只与 $\rho(M)$ 有关（与系数矩阵 $A$ 及演变方式有关）与常数项和初始向量的选择无关

- 设 $n$ 阶方阵 $A$ 的特征值为 $\lambda_i$ $(i=1,2,\cdots,n)$，则 $\rho(A)=\max_{1\leq i\leq n}\vert\lambda_i\vert$，即矩阵谱半径为其特征值的绝对值最大值

- 由于谱半径计算方法比较困难，故寻找三个范数有关充分条件证明收敛：
	- 1. 若 $\mu=\Vert M\Vert_{\infty}\textless1$，则对于任意初值简单迭代法收敛，且 $\Vert X^{(k)}-\alpha\Vert_{\infty}\leq\frac{\mu^k}{1-\mu}\Vert X^{(1)}-X^{(0)}\Vert_{\infty}$
	- 2. 若 $\nu=\Vert M\Vert_1\textless1$，则对于任意初值简单迭代法收敛，且 $\Vert X^{(k)}-\alpha\Vert_1\leq\frac{\nu^k}{1-\nu}\Vert X^{(1)}-X^{(0)}\Vert_1$
	- 3. 若 $p=\Vert M\Vert_F\textless1$，则对于任意初值简单迭代法收敛，且 $\Vert X^{(k)}-\alpha\Vert_2\leq\frac{p^k}{1-p}\Vert X^{(1)}-X^{(0)}\Vert_2$
	- 其中 $\alpha$ 是方程组的真解，$X^{(k)}-\alpha$ 表示 $k$ 次迭代之后的误差向量
	- 上述三条充分条件均属于大范围收敛条件，即收敛性均与初值选取无关


- 例 2：讨论简单迭代法求解下列线性方程组的收敛性：$$\begin{cases}0.2x_1+0.1x_2+0.3x_3=1.3\\ 0.1x_1+0.3x_2+0.2x_3=1.3\\ 0.3x_1+0.2x_2+0.1x_3=1\end{cases}$$

- 解法：取迭代矩阵 $C=I-A$：$$C=\begin{bmatrix}0.8&-0.1&-0.3\\ -0.1&0.7&-0.2\\ -0.3&-0.2&0.9\end{bmatrix}$$求解矩阵特征值：$$CX=\lambda X\Rightarrow(\lambda I-C)X=0$$$X$ 为特征向量，非零，故方程组应存在非零解，有：$$\vert\lambda I-C\vert=\begin{vmatrix}\lambda-0.8&0.1&0.3\\ 0.1&\lambda-0.7&0.2\\ 0.3&0.2&\lambda-0.9\end{vmatrix}=0$$得到：$$\lambda^3-3.9\lambda^2+3.12\lambda-0.388=0\Rightarrow \lambda_1=0.15218,\ \lambda_2=0.89316,\ \lambda_3=2.85467$$谱半径：$$\rho(C)=\max(\lambda_1,\lambda_2,\lambda_3)=2.85467\textgreater1$$因此判断：简单迭代法求解该线性方程组不收敛

- 旁注：上述关于 $\lambda$ 的三次方程组可以通过迭代公式：$$\lambda^{(k+1)}=\frac{0.388}{(\lambda^{(k)})^2-3.9\lambda^{(k)}+3.12}$$ 求得第一根 $0.15218$


##### 雅可比迭代法 Jacobi Iteration：

- 雅可比迭代法的实质是分离变量，将线性方程组：$$\begin{cases}a_{11}x_1+a_{12}x_2+a_{13}x_3=b_1\\ a_{21}x_1+a_{22}x_2+a_{23}x_3=b_2\\ a_{31}x_1+a_{32}x_2+a_{33}x_3=b_3\end{cases}$$化成如下的形式：$$\begin{cases}x_1=-\frac{a_{12}}{a_{11}}x_2-\frac{a_{13}}{a_{11}}x_3+\frac{b_{1}}{a_{11}}\\ x_2=-\frac{a_{21}}{a_{22}}x_1-\frac{a_{23}}{a_{22}}x_3+\frac{b_{2}}{a_{22}}\\ x_1=-\frac{a_{31}}{a_{33}}x_1-\frac{a_{32}}{a_{33}}x_2+\frac{b_{3}}{a_{33}}\end{cases}$$即 $AX=B\Rightarrow X=GX+F$，其中：$$G=\begin{bmatrix}0&g_{12}&g_{13}\\ g_{21}&0&g_{23}\\ g_{31}&g_{32}&0\end{bmatrix},\ \ \ \ F=\begin{bmatrix}f_1\\ f_2\\ f_3\end{bmatrix}$$其中：$$g_{ij}=\frac{a_{ij}}{a_{ii}},i\neq j,\ \ \ \ g_{ii}=0,\ \ \ \ f_{i}=\frac{b_i}{a_{ii}}$$其迭代方程为：$$X^{(k+1)}=GX^{(k)}+F$$

- 雅可比迭代法的收敛条件同上述简单迭代法，充分必要条件仍为 $\rho(G)\textless1$

- 需要注意：雅可比迭代法收敛性的判断与简单迭代法相同，但是由于迭代矩阵不同，故当求解同一个线性方程组时，两种方法收敛性不同

- 对于方程 $AX=B$ 的 $A$，可以拆成 $A=L+D+U$ 形式：$$L=\begin{bmatrix}0\\ a_{21}&0\\ a_{31}&a_{32}&0\\ \vdots&\vdots&&\ddots\\ a_{n1}&a_{n2}&\cdots&a_{n,n-1}&0\end{bmatrix},\ \ \ \ U=\begin{bmatrix}0&a_{12}&a_{13}&\cdots&a_{1n}\\ &0&a_{23}&\cdots&a_{2n}\\ &&0&\cdots&a_{3n}\\ &&&\ddots&\vdots\\ &&&&0\end{bmatrix}$$$$D=\begin{bmatrix}a_{11}\\ &a_{22}\\ &&a_{33}\\ &&&\ddots\\ &&&&a_{nn}\end{bmatrix}$$则雅可比迭代法中迭代矩阵 $G=D^{-1}(L+U)$

- 求解迭代矩阵特征值：$$\begin{vmatrix}\lambda I-D^{-1}(L+U)\end{vmatrix}=0\Rightarrow\begin{vmatrix}\lambda D-(L+U)\end{vmatrix}=0$$即：$$\begin{vmatrix}\lambda a_{11}&-a_{12}&-a_{13}\\ -a_{21}&\lambda a_{22}&-a_{23}\\ -a_{31}&-a_{32}&\lambda a_{33}\end{vmatrix}=0$$通过特征值可以判断雅可比迭代法是否收敛


- 例 3：验证雅可比迭代法解下列线性方程组可以收敛，并求解：$$\begin{cases}10x_1-x_2-2x_3=72\\ -x_1+10x_2-2x_3=83\\ -x_1-x_2+5x_3=42\end{cases}$$

- 解法：先验证收敛性：$$\begin{vmatrix}10\lambda&1&2\\ 1&10\lambda&2\\ 1&1&5\lambda\end{vmatrix}=0\ \Rightarrow\ 500\lambda^3-45\lambda+4=0\ \Rightarrow\begin{cases}\lambda_1=-0.33723\\ \lambda_2=0.23723\\ \lambda_3=0.10000\end{cases}$$谱半径 $\rho(G)=\vert\lambda_1\vert=0.33723\textless1$，故雅可比迭代法收敛，雅可比迭代式为：$$\begin{cases}x_1^{(k+1)}=0.1x_2^{(k)}+0.2x_3^{(k)}+7.2\\ x_2^{(k+1)}=0.1x_1^{(k)}+0.2x_3^{(k)}+8.3\\ x_3^{(k+1)}=0.2x_1^{(k)}+0.2x_2^{(k)}+8.4\end{cases}$$取迭代初始值为：$$X_0=\begin{bmatrix}0\\ 0\\ 0\end{bmatrix}$$则重复迭代 $9$ 次：$$X_1=\begin{bmatrix}7.2\\ 8.3\\ 8.4\end{bmatrix},\ \ X_2=\begin{bmatrix}9.71\\ 10.70\\ 11.50\end{bmatrix},\ \ X_3=\begin{bmatrix}10.570\\ 11.570\\ 12.482\end{bmatrix},\ \ X_4=\begin{bmatrix}10.8535\\ 11.8534\\ 12.8282\end{bmatrix},\ \ X_5=\begin{bmatrix}10.9510\\ 11.9510\\ 12.9414\end{bmatrix}$$$$X_6=\begin{bmatrix}10.9834\\ 11.9834\\ 12.9504\end{bmatrix},\ \ X_7=\begin{bmatrix}10.9944\\ 11.9981\\ 12.9934\end{bmatrix},\ \ X_8=\begin{bmatrix}10.9981\\ 11.9941\\ 12.9978\end{bmatrix},\ \ X_9=\begin{bmatrix}10.9994\\ 11.9994\\ 12.9992\end{bmatrix}$$不妨尝试取：$x_1=11$，$x_2=12$，$x_3=13$，回代方程组检验成立，故线性方程组的解为：$$\begin{cases}x_1=11\\ x_2=12\\ x_3=13\end{cases}$$


##### 雅可比迭代法收敛的充分条件定理：

- 矩阵可约性的概念：如果矩阵 $A$ 不能通过行的次序调换和相应列的次序调换（即同时操作 $R_{ij}$ 与 $C_{ij}$，$(i,j=1,2,\cdots,n)$）成为：$$\begin{bmatrix}A_{11}&A_{12}\\ 0&A_{22}\end{bmatrix},\ \ 其中\ A_{11}\ 和\ A_{22}\ 为方阵$$则称 $A$ 为不可约矩阵；否则称为可约矩阵

- 如果矩阵的所有特征值都是单根，即没有重复的特征值，那么矩阵是不可约的

- 矩阵对角占优的概念：如果矩阵 $A$ 的对角线元素满足：$$\vert a_{ii}\vert\geq\Sigma_{j=1,\ j\neq i}^n\vert a_{ij}\vert,\ \ \ \ (i=1,2,\cdots,n)$$且至少有一个 $i$ 值使上式中有严格不等号成立，则称 $A$ 具有对角占优性

- 若矩阵 $A$ 不可约，且具有对角占优，则 $A$ 为非奇异矩阵且 $a_{ii}\neq0$，$(i=1,2,\cdots,n)$

- 定理：若系数矩阵 $A$ 不可约且具有对角占优，则雅可比迭代法必定收敛


- 例 4：判断雅可比迭代法在解下述线性方程组的收敛性：$$\begin{cases}5x_1+2x_2+x_3=-12\\ -x_1+4x_2+2x_3=20\\ 2x_1-3x_2+10x_3=3\end{cases}$$

- 解法：求方程组系数矩阵的特征值：$$\begin{vmatrix}5\lambda&-2&-1\\ 1&4\lambda&-2\\ -2&3&10\lambda\end{vmatrix}=0\ \Rightarrow\ 200\lambda^3+42\lambda-11=0$$在不解特征值方程的情况下，根据单调递增函数的性质，可以判断方程只有一个实根，由此可知剩余的两个根均是复数，且是共轭复数，故该方程无重复特征值，因此判断系数矩阵 $A$ 不可约；同样可以发现，该方程组系数满足：$$\vert a_{11}\vert\textgreater\vert a_{12}\vert+\vert a_{13}\vert,\ \ \ \ \vert a_{22}\vert\textgreater\vert a_{21}\vert+\vert a_{23}\vert,\ \ \ \ \vert a_{33}\vert\textgreater\vert a_{31}\vert+\vert a_{32}\vert$$因此可知方程组系数矩阵 $A$ 具有对角占优，通过 $A$ 不可约条件和对角占优条件得出结论：雅可比迭代法收敛


- 矩阵不可约的图论判断法：
	- 将矩阵 $A=\begin{bmatrix}a_{ij}\end{bmatrix}$ 表示为有向图，其中节点代表矩阵的行 / 列，边 $i\to j$ 存在当且仅当 $a_{ij}\neq0$
	- 如果矩阵对应的有向图是强连通的（即任意两个节点之间都存在路径），则矩阵不可约
	- 如果图不是强连通的，则矩阵可约


#### 2. 赛德尔迭代法 Seidel Iteration

##### 赛德尔迭代法 Seidel Iteration：

- 赛德尔迭代法 Seidel Iteration 的迭代格式为：$$x_i^{(k+1)}=\Sigma_{j=1}^{i=1}\ m_{ij}x_j^{(k+1)}+\Sigma_{j=i}^n\ m_{ij}x_j^{(k)}X_{j}^{(k)}+n_i,\ \ \ \ (i=1,2,\cdots,n;\ k=0,1,2,\cdots)$$即：$$\begin{cases}x_1^{(k+1)}=m_{11}x_1^{(k)}+m_{12}x_2^{(k)}+\cdots+m_{1n}x_n^{(k)}+n_1\\ x_2^{(k+1)}=m_{21}x_1^{(k+1)}+m_{22}x_2^{(k)}+\cdots+m_{2n}x_n^{(k)}+n_2\\ x_3^{(k+1)}=m_{31}x_1^{(k+1)}+m_{32}x_2^{(k+1)}+m_{33}x_3^{(k)}+\cdots+m_{3n}x_n^{(k)}+n_3\\ \cdots\cdots\cdots\cdots\\ x_n^{(k+1)}=m_{m1}x_1^{(k)}+m_{m2}x_2^{(k+1)}+\cdots+m_{n,n-1}x_{n-1}^{(k+1)}+m_{nn}x_n^{(k)}+n_n\end{cases}$$用矩阵记为：$$X^{(k+1)}=M_1X^{(k+1)}+M_2x^{(k)}+N,\ \ \ \ (M=M_1+M_2)$$其中：$$M_1=\begin{bmatrix}0&&&&0\\ m_{21}&0\\ m_{31}&m_{32}&0\\ \cdots&&\ddots&\ddots\\ m_{n1}&\cdots&\cdots&m_{n,n-1}&0\end{bmatrix},\ \ M_2=\begin{bmatrix}m_{11}&m_{12}&m_{13}&\cdots&m_{1n}\\ &m_{22}&m_{23}&\cdots&m_{2n}\\ &&m_{33}&\cdots&m_{3n}\\ &&&\ddots&\vdots\\ 0&&&&m_{nn}\end{bmatrix},\ \ N=\begin{bmatrix}n_1\\ n_2\\ n_3\\ \cdots\\ n_n\end{bmatrix}$$

##### 高斯 - 赛德尔迭代法 Gauss - Seidel Iteration：

- 当赛德尔迭代法采用雅可比迭代法的迭代格式，即：$$x_i^{(k+1)}=-\frac{1}{a_{ii}}(\Sigma_{j=1}^{i-1}\ a_{ij}x_j^{(k+1)}+\Sigma_{j=i+1}^n\ a_{ij}x_j^{(k)}X_{j}^{(k)}-b_i),\ \ \ \ (i=1,2,\cdots,n;\ k=0,1,2,\cdots)$$或：$$X^{(k+1)}=G_1X^{(k+1)}+G_2X^{(k)}+F$$此时这种方法称为“高斯 - 赛德尔迭代法 Gauss - Seidel Iteration”


- 例 5：用高斯 - 赛德尔迭代法求解线性方程组：$$\begin{cases}10x_1-x_2-2x_3=72\\ -x_1+10x_2-2x_3=83\\ -x_1-x_2+5x_3=42\end{cases}$$

- 解法：将方程组改写成如下迭代格式：$$\begin{cases}x_1^{(k+1)}=0.1x_2^{(k)}+0.2x_3^{(k)}+7.2\\ x_2^{(k+1)}=0.1x_1^{(k+1)}+0.2x_3^{(k)}+8.3\\ x_3^{(k+1)}=0.2x_1^{(k+1)}+0.2x_2^{(k+1)}+8.4\end{cases}$$假设初始解向量为：$$X_0=\begin{bmatrix}0\\ 0\\ 0\end{bmatrix}$$迭代 $6$ 次：$$X_1=\begin{bmatrix}7.2\\ 9.02\\ 11.644\end{bmatrix},\ \ X_2=\begin{bmatrix}10.4308\\ 11.6719\\ 12.8205\end{bmatrix},\ \ X_3=\begin{bmatrix}10.9313\\ 11.9572\\ 12.9778\end{bmatrix},$$$$X_4=\begin{bmatrix}10.9913\\ 11.9947\\ 12.9972\end{bmatrix},\ \ X_5=\begin{bmatrix}10.9989\\ 11.9993\\ 12.9996\end{bmatrix},\ \ X_6=\begin{bmatrix}10.9999\\ 11.9999\\ 12.9999\end{bmatrix}$$取 $x_1=11$，$x_2=12$，$x_3=13$，回代检验成立，故该方程组的解为：$$\begin{cases}x_1=11\\ x_2=12\\ x_3=13\end{cases}$$


- 通过与上面例 3 雅可比迭代法对比可以发现，高斯 - 赛德尔迭代法在解这个方程组中迭代六次的结果比雅可比迭代法迭代九次的结果精度还要高

##### 高斯 - 赛德尔迭代法的收敛性：

- 赛德尔迭代法有迭代式：$$X^{(k+1)}=M_1X^{(k+1)}+M_2X^{(k)}+N,\ \ \ \ (M=M_1+M_2)$$化为简单迭代法的基本形式：$$(I-M_1)X^{(k+1)}=M_2X^{(k)}+N\ \Rightarrow\ X^{(k+1)}=(I-M_1)^{-1}M_2X^{(k)}+(I-M_1)^{-1}N$$故可推出其收敛充分必要条件为：$$\rho(\ (I-M_1)^{-1}M_2\ )\textless1$$

- 由于谱半径计算方法比较困难，故寻找三个范数有关充分条件证明收敛：
	- 1. 若 $\mu=\Vert M\Vert_{\infty}\textless1$，则对于任意初值简单迭代法收敛，且 $\Vert X^{(k)}-\alpha\Vert_{\infty}\leq\frac{(\mu^*)^k}{1-\mu^*}\Vert X^{(1)}-X^{(0)}\Vert_{\infty}$，其中 $\mu^*=\max_{i}\frac{\mu_i}{1-r_i}$，$r_i=\Sigma_{j=1}^{i-1}\vert m_{ij}\vert$，$\mu_i=\Sigma_{j=i}^n\vert m_{ij}\vert$
	- 2. 若 $\nu=\Vert M\Vert_1\textless1$，则对于任意初值简单迭代法收敛，且 $\Vert X^{(k)}-\alpha\Vert_1\leq\frac{\rho^k}{(1-s)(1-\rho)}\Vert X^{(1)}-X^{(0)}\Vert_1$，其中 $t_j=\Sigma_{i=1}^j\vert m_{ij}\vert$，$s_j=\Sigma_{i=j+1}^n\vert m_{ij}\vert$，$s=\max_j\vert m_{ij}\vert$，$\rho=\max_j\frac{t_j}{1-s_j}$
	- 3. 若 $p=\Vert M\Vert_F\textless1$，则对于任意初值简单迭代法收敛，且 $\Vert X^{(k)}-\alpha\Vert_2\leq\frac{\rho^k}{(1-s)(1-\rho)}\Vert X^{(1)}-X^{(0)}\Vert_2$，其中 $\theta_i=\Sigma_{j=1}^n\ m_{ij}^2,\ \ (k=1,2,\cdots,n)$，$t_j=\Sigma_{i=1}^j\ \theta_j$，$s_j=\Sigma_{i=j+1}^n\ \theta_i$，$s=\max_j\ s_j$，$\rho=\max_j\frac{ij}{1-s_J}$
	- 其中 $\alpha$ 是方程组的真解，$X^{(k)}-\alpha$ 表示 $k$ 次迭代之后的误差向量
	- 上述三条充分条件均属于大范围收敛条件，即收敛性均与初值选取无关

- 对于方程 $AX=B$ 的 $A$，可以拆成 $A=L+D+U$ 形式：$$L=\begin{bmatrix}0\\ a_{21}&0\\ a_{31}&a_{32}&0\\ \vdots&\vdots&&\ddots\\ a_{n1}&a_{n2}&\cdots&a_{n,n-1}&0\end{bmatrix},\ \ \ \ U=\begin{bmatrix}0&a_{12}&a_{13}&\cdots&a_{1n}\\ &0&a_{23}&\cdots&a_{2n}\\ &&0&\cdots&a_{3n}\\ &&&\ddots&\vdots\\ &&&&0\end{bmatrix}$$$$D=\begin{bmatrix}a_{11}\\ &a_{22}\\ &&a_{33}\\ &&&\ddots\\ &&&&a_{nn}\end{bmatrix}$$则高斯 - 赛德尔迭代法中迭代矩阵为：$$G=-(D+L)^{-1}U$$则高斯 - 赛德尔迭代收敛的充分必要条件为：$$\rho(\ -(D+L)^{-1}U\ )\textless1$$求 $-(D+L)^{-1}U$ 的特征值：$$\vert\lambda I+(D+L)^{-1}U\vert=0\ \Rightarrow\ \vert\lambda(D+L)+U\vert=0$$即：$$\begin{vmatrix}\lambda a_{11}&a_{12}&a_{13}\\ \lambda a_{21}&\lambda a_{22}&a_{23}\\ \lambda a_{31}&\lambda a_{32}&\lambda a_{33}\end{vmatrix}=0$$


- 例 6：判断用高斯 - 赛德尔迭代法求解线性方程组是否收敛：$$\begin{cases}4x_1+2x_2+x_3=7\\ -x_1+8x_2-6x_3=1\\ -5x_1+4x_2+x_3=0\end{cases}$$

- 解法：求高斯 - 赛德尔迭代矩阵特征值：$$\begin{vmatrix}4\lambda&2&1\\ -\lambda&8\lambda&-6\\ -5\lambda&4\lambda&\lambda\end{vmatrix}=0\ \Rightarrow\ 32\lambda^3+138\lambda^2+54\lambda=0\ \Rightarrow\ \lambda_1=0,\ \lambda_2=-3.8773,\ \lambda=-0.4352$$由于 $\rho(G)=\vert\lambda_2\vert=3.8873\textless1$，故高斯 - 赛德尔迭代解法在此方程组不收敛


- 定理：若系数矩阵 $A$ 不可约且具有对角占优，则高斯 - 赛德尔迭代法必定收敛

- 定理：若系数矩阵 $A$ 对称正定，则高斯 - 赛德尔迭代法收敛


- 例 7：判断用高斯 - 赛德尔迭代法与雅可比迭代法求解线性方程组是否收敛：$$\begin{cases}10x_1+x_3-5x_4=-7\\ x_1+8x_2-3x_3=11\\ 3x_1+2x_2-8x_3+x_4=23\\ x_1-2x_2+2x_3+7x_4=17\end{cases}$$

- 解法：系数矩阵：$$A=\begin{bmatrix}10&0&1&-5\\ 1&8&-3&0\\ 3&2&-8&1\\ 1&-2&2&7\end{bmatrix}$$具有严格对角占优，且利用图论判断法易知不可约，故雅可迭代法和高斯 - 赛德尔迭代法均收敛


#### 3. 松弛迭代法 SOR Iteration：

##### 松弛迭代法 SOR Iteration：

- 对于 $AX=B$ 的一行：$$a_{i1}x_1+a_{i2}x_2+\cdots+a_{in}x_n=b_i$$有残差：$$R_i=b_i-(a_{i1}x_1+a_{i2}x_2+\cdots+a_{in}x_n$$为了将残差减小，将一个方程中的一个变量修改，使该方程残差为零，这一过程称为“方程的松弛或削弱”

- 一般对于第 $i$ 个方程，总改变其第 $i$ 个变量 $x_i$ 的数值，使该方程残差为零，在此之前先将将残差改写为：$$r_i=\frac{R_i}{a_{ii}}=-x_i-\frac{1}{a_{ii}}(a_{i1}x_1+\cdots+a_{i,i-1}x_{i-1}+a_{i,i+1}x_{i+1}+\cdots+a_{in}x_n)+\frac{b_i}{a_{ii}}$$

##### 按 $\vert r_i\vert$ 最大实施松弛方法（按 $\max_i\vert r_i^{(k)}\vert$ 松弛法）：

- 在松弛迭代法的基础上选择残差绝对值最大的第 $s$ 个方程，修改第 $s$ 个未知量的值，使第 $s$ 个方程的残差为 $0$

- $r_s^{(0)}$ 是 $x_s^{(0)}$ 的修正量：$x_s^{(1)}=x_s^{(0)}+r_s^{(0)}$，即：$$r_s^{(0)}=-x_s^{(0)}+(-\frac{a_{i1}}{a_{ii}}x_1-\cdots-\frac{a_{i,i+1}}{a_{ii}}x_{i-1}-\frac{a_{i,i+1}}{a_{ii}}x_{i+1}-\cdots-\frac{a_{in}}{a_{ii}}x_n)+\frac{b_i}{a_{ii}}$$等式左右两边各减去一个 $r_s^{(0)}$，则所有方程中的 $x_s^{(0)}$ 都要增加 $r_s^{(0)}$，这相当于每个方程的残差都减少了 $\frac{a_{is}}{a_{ii}}x_s^{(0)}$，即 $r_i^{(1)}=r_i^{(0)}-\frac{a_{is}}{a_{ii}}r_s^{(0)}$


- 例 8：求用按最大残差松弛法求解线性方程组的前三次迭代结果：$$\begin{cases}10x_1-2x_2-2x_3=6\\ -x_1+10x_2-2x_3=7\\ -x_1-x_2+10x_3=8\end{cases}$$

- 解法：改写成残差方程：$$\begin{cases}r_1^{(k)}=0.6-x_1^{(k)}+0.2x_2^{(k)}+0.2x_3^{(k)}\\ r_2^{(k)}=0.7+0.1x_1^{(k)}-x_2^{(k)}+0.2x_3^{(k)}\\ r_3^{(k)}=0.8+0.1x_1^{(k)}+0.1x_2^{(k)}-x_3^{(k)}\end{cases}$$取初始解向量：$$X_0=\begin{bmatrix}0\\ 0\\ 0\end{bmatrix}$$得到：$$r_1^{(0)}=0.6,\ \ \ \ r_2^{(0)}=0.7,\ \ \ \ r_3^{(0)}=0.8$$由于 $\vert r_3^{(0)}\vert$ 最大，故讲 $x_3$ 增加 $0.8$，使 $r_3^{(1)}=0$，此时：$$x_3^{(1)}=0.8\ \Rightarrow\ r_1^{(1)}=0.76,\ \ r_2^{(1)}=0.86$$此时 $\vert r_2^{(1)}\vert$ 最大，故将 $x_2$ 增加 $0.86$，使 $r_2^{(2)}=0$，此时：$$x_2^{(2)}=0.86\ \Rightarrow\ r_1^{(2)}=0.932,\ \ r_3^{(2)}=0.086$$此时 $\vert r_1^{(2)}\vert$ 最大，故将 $x_1$ 增加 $0.932$，使 $r_1^{(3)}=0$，此时：$$x_1^{(3)}=0.932\ \Rightarrow\ r_2^{(3)}=0.0932,\ \ r_3^{(3)}=0.1792$$循环往复，直至近似值的全部修改量均小于给定的精度要求


##### 简单迭代和赛德尔迭代方式下的逐次松弛法：

- 根据方程排列的顺序 $i=1,2,\cdots,n$ 修改 $x_i^{(k)}$ 为 $\hat{x_i}$ 使 $r_i^{(k+1)}\equiv0$，则 $x_i^{(k+1)}=\hat{x_i}=x_i^{(k)}+r_i^{(k)}$，$(i=1,2,\cdots,n)$

- 残差消为零后，得：$$x_i^{(k+1)}=-\frac{1}{a_{ii}}(a_{i1}x^{(k+1)}+\cdots+a_{in}x_n^{(k)}-b_i)$$等同于赛德尔迭代法

- 用松弛因子 $\widetilde{\omega}$ 修改公式：$$x_i^{(k+1)}=x_i^{(k)}+\widetilde{\omega}r_i^{(k)}=x_i^{(k)}+\frac{\widetilde{\omega}}{a_{ii}}R_i^{(k)},\ \ \ \ (i=1,2,\cdots,n)$$当 $\widetilde{\omega}=1$ 时，又转为上述赛德尔迭代法

- 由于残差 $r_i^{(k)}=\hat{x_i}-x_i^{(k)}$，故：$$x_i^{(k+1)}=x_i^{(k)}+\widetilde{\omega}(\hat{x_i}-x_i^{(k)})=(1-\widetilde{\omega})x_i^{(k)}+\widetilde{\omega}\hat{x_i},\ \ \ \ (i=1,2,\cdots,n)$$其中：$$\hat{x_i}=-\frac{1}{a_{ii}}(a_{i1}x_1^{(k)}+\cdots+a_{i,i-1}x_{i-1}^{(k)}+a_{i,i+1}x_{i+1}^{(k)}+\cdots+a_{in}x_n^{(k)}-b_i)$$故：$$x_i^{(k+1)}=(1-\widetilde{\omega})x_i^{(k)}-\frac{\widetilde{\omega}}{a_{ii}}(a_{i1}x_1^{(k)}+\cdots+a_{i,i-1}x_{i-1}^{(k)}+a_{i,i+1}x_{i+1}^{(k)}+\cdots+a_{in}x_n^{(k)}-b_i)$$这是雅可比迭代法中新旧两个迭代值 $x_i^{(k+1)}$ 与 $x_i^{(k)}$ 按 $\widetilde{\omega}$ 与 $(1-\widetilde{\omega})$ 加权的组合公式

- 赛德尔迭代方式下的逐次松弛法：$$x_i^{(k+1)}=(1-\widetilde{\omega})x_i^{(k)}-\frac{\widetilde{\omega}}{a_{ii}}(a_{i1}x_1^{(k+1)}+\cdots+a_{i,i-1}x_{i-1}^{(k+1)}+a_{i,i+1}x_{i+1}^{(k)}+\cdots+a_{in}x_n^{(k)}-b_i)$$$$=x_i^{(k)}-\frac{\widetilde{\omega}}{a_{ii}}(a_{i1}x_1^{(k+1)}+\cdots+a_{i,i-1}x_{i-1}^{(k+1)}+a_{ii}x_i^{(k)}+a_{i,i+1}x_{i+1}^{(k)}+\cdots+a_{in}x_n^{(k)}-b_i)$$


- 例 9：求用赛德尔迭代方式下的松弛法解线性方程组迭代三次的结果：$$\begin{cases}4x_1+3x_2=24\\ 3x_1+4x_2-x_3=30\\ -x_2+4x_3=-24\end{cases}$$

- 解法：列赛德尔迭代方式下松弛迭代方程：$$\begin{cases}x_1^{(k+1)}=x_1^{(k)}-\frac{\widetilde{\omega}}{4}(4x_1^{(k)}+3x_2^{(k)}-24)\\ x_2^{(k+1)}=x_2^{(k)}-\frac{\widetilde{\omega}}{4}(3x_1^{(k+1)}+4x_2^{(k)}-x_3^{(k)}-30)\\ x_3^{(k+1)}=x_3^{(k)}-\frac{\widetilde{\omega}}{4}(-x_2^{(k+1)}+4x_3^{(k)}+24)\end{cases}$$选取 $\widetilde{\omega}=1.25$，则上述方程变为：$$\begin{cases}x_1^{(k+1)}=-0.25x_1^{(k)}-0.9375x_2^{(k)}+7.5\\ x_2^{(k+1)}=-0.9375x_1^{(k+1)}-0.25x_2^{(k)}+0.3125x_3^{(k)}+9.375\\ x_3^{(k+1)}=0.3125x_2^{(k+1)}-0.25x_3^{(k)}-7.5\end{cases}$$取初始解向量为：$$X_0=\begin{bmatrix}0\\ 0\\ 0\end{bmatrix}$$循环迭代得到前三次迭代结果：$$X_1=\begin{bmatrix}7.5000\\ 2.3438\\ -6.7676\end{bmatrix},\ \ \ \ X_2=\begin{bmatrix}5.6250\\ 3.5156\\ -4.7095\end{bmatrix},\ \ \ \ X_3=\begin{bmatrix}6.0938\\ 2.7832\\ -5.4529\end{bmatrix}$$

- 上述题目编程迭代结果如下：
~~~
第1次迭代：x1:7.5  x2:2.34375  x3:-6.76758
第2次迭代：x1:5.625  x2:3.51562  x3:-4.70947
第3次迭代：x1:6.09375  x2:2.7832  x3:-5.45288
第4次迭代：x1:5.97656  x2:3.07617  x3:-5.17548
第5次迭代：x1:6.00586  x2:2.97546  x3:-5.2763
第6次迭代：x1:5.99854  x2:3.00751  x3:-5.24108
第7次迭代：x1:6.00037  x2:2.99778  x3:-5.25292
第8次迭代：x1:5.99991  x2:3.00064  x3:-5.24907
第9次迭代：x1:6.00002  x2:2.99982  x3:-5.25029
第10次迭代：x1:5.99999  x2:3.00005  x3:-5.24991
第11次迭代：x1:6  x2:2.99999  x3:-5.25003
第12次迭代：x1:6  x2:3  x3:-5.24999
第13次迭代：x1:6  x2:3  x3:-5.25
第14次迭代：x1:6  x2:3  x3:-5.25
第15次迭代：x1:6  x2:3  x3:-5.25
~~~
可以看到，在第 13 次迭代结果就已经收敛，说明合理的松弛迭代法的加速效果非常明显


- 一般把 $\widetilde{\omega}$ 称为“松弛因子”，当 $\widetilde{\omega}=1$，称为“恰当松弛”；当 $\widetilde{\omega}\textgreater1$，称为“超松弛”；当 $\widetilde{\omega}\textless1$，称为“低松弛”

- 松弛法收敛的必要条件是：$0\textless\widetilde{\omega}\textless2$

- 若方程组系数矩阵 $A$ 为对称正定矩阵，则当 $0\textless\widetilde{\omega}\textless2$ 时，松弛法恒收敛

- 若方程组系数矩阵 $A$ 为不可约、对角占优矩阵，且松弛因子满足：$0\textless\widetilde{\omega}\leq1$ 时，则松弛法必收敛

- 注意：松弛因子只有合适时才会提速收敛，不是 $\widetilde{\omega}$ 越大就越好

##### 最优松弛因子的选取：

- 设方程组系数矩阵 $A$ 为 $R^{n\times n}$ 中对称正定的三对角矩阵，$G_J$ 为雅可比迭代法迭代矩阵，若 $\rho(G_J)\textless1$，则最优松弛因子为：$$\widetilde{\omega}_{OPT}=\frac{2}{1+\sqrt{1-\rho^2(G_J)}}$$


- 例 10：求用雅可比迭代方式下的松弛迭代法解线性方程组的最优松弛因子：$$\begin{cases}5x_1-x_2=3\\ -x_1+4x_2+2x_3=13\\ 2x_2+9x_3=31\end{cases}$$

- 解法：求雅可比迭代法迭代矩阵特征值：$$A=\begin{bmatrix}5&-1&0\\ -1&4&2\\ 0&2&9\end{bmatrix},\ \ \ \ 令\begin{vmatrix}5\lambda&-1&0\\ -1&4\lambda&2\\ 0&2&9\lambda\end{vmatrix}=0,\ \ \ \ 得：\begin{cases}\lambda_1=0\\ \lambda_2=-0.4014\\ \lambda_3=0.4014\end{cases}$$故迭代矩阵谱半径为：$\rho(G_J)=\vert\lambda_3\vert=0.4014\textless1$，因此最优松弛因子：$$\widetilde{\omega}_{OPT}=\frac{2}{1+\sqrt{1-(0.4014)^2}}=1.0439$$


#### 4. 共轭梯度法：

##### 共轭梯度法 Conjugate Gradient Method，CG：

- 当线性方程组 $AX=B$ 的系数矩阵 $A$ 是对称正定矩阵时，可以采用共轭梯度法进行求解

- 可以证明，下式所示的 $n$ 元二次函数：$$f(X)=\frac{1}{2}X^TAX-B^TX$$取得极小值点 $X^*$ 是方程 $AX=B$ 的解

- 共轭梯度法是把求解线性方程组的问题转化为求解一个与之等价的二次函数极小化的问题：从任意给定的初始点出发，沿一组关于矩阵 $A$ 的共轭方向进行线性搜索，在无舍入误差的假定下，最多迭代 $n$ 次（其中 $n$ 为矩阵 $A$ 的阶数），就可求得二次函数的极小点，即线性方程组 $AX=B$ 的解；其迭代公式为：$$X^{(k+1)}=X^{(k)}+\alpha_kd^{(k)}$$

- 共轭梯度法的关键是最佳步长 $\alpha_k$ 和搜索方向 $d^{(k)}$ 的确定，其中 $\alpha_k$ 可以通过一元函数 $\phi(\alpha)=f(X^{(k)}+\alpha d^{(k)})$ 的极小化来求得，其表达式为公式：$$\alpha_k=\frac{r^{(k)T}r^{(k)}}{d^{(k)T}Ad^{k}}$$取 $d^{(0)}=r^{(0)}=B-AX^{(0)}$，则 $d^{(k+1)}=r^{(k+1)}+\beta_k d^{(k)}$，要求 $d^{(k+1)}$ 满足 $(d^{(k+1)},\ Ad^{(k)})=0$（正交，即内积为零），可得 $\beta_k$ 的表达式：$$\beta_k=-\frac{r^{(k+1)T}Ad^{(k)}}{d^{(k)T}Ad^{(k)}}$$这种更新方式称为 “Hestenes-Stiefel 更新”

- $\beta_k$ 有三种常见的更新方式：
	- Fletcher-Reeves 更新：$$\beta_k=\frac{r^{(k+1)T}\ r^{(k+1)}}{r^{(k)T}\ r^{(k)}}$$
	- Polak-Ribière 更新：$$\beta_k=\frac{r^{(k+1)T}\ (r^{(k+1)}-r^{(k)})}{r^{(k)T}\ r^{(k)}}$$
	- Hestenes-Stiefel 更新：$$\beta_k=-\frac{r^{(k+1)T}Ad^{(k)}}{d^{(k)T}Ad^{(k)}}$$

- 经过一系列的证明和简化，最终可得共轭梯度法的计算过程如下（这里以 “Fletcher-Reeves 更新” 为例）：
	- 1. 给定初始解向量 $X^{(0)}$ 及精度 $\epsilon\textgreater0$
	- 2. 计算 $r^{(0)}=B-AX^{(0)}$，取 $d^{(0)}=r^{(0)}$
	- 3. `for k=0 to n-1 do`
		- *I.* $\alpha_k=\frac{r^{(k)T}r^{(k)}}{d^{(k)T}Ad^{k}}$
		- *II.* $X^{(k+1)}=X^{(k)}+\alpha_kd^{(k)}$
		- *III.* $r^{(k+1)}=B-AX^{(k+1)}=r^{(k)}-\alpha_k Ad^{(k)}$
		- *IV.* 若 $\Vert r^{(k+1)}\Vert\leq\epsilon$ 或 $k+1=n$，则输出近似解 $X^{(k+1)}$，停止；否则转下一步进行
		- *V.* $\beta_k=\frac{r^{(k+1)T}\ r^{(k+1)}}{r^{(k)T}\ r^{(k)}}$
		- *VI.* $d^{(k+1)}=r^{(k+1)}+\beta_k d^{(k)}$
		`end do`


- 例 11：用共轭梯度法求解线性方程组：$$\begin{cases}x_1+2x_2+3x_3=12\\ 2x_1+5x_2+4x_3=22\\ 3x_1+4x_2+6x_3=26\end{cases}$$

- 解法：系数矩阵和常数向量：$$A=\begin{bmatrix}1&2&3\\ 2&5&4\\ 3&4&6\end{bmatrix},\ \ \ \ B=\begin{bmatrix}12\\ 22\\ 26\end{bmatrix}$$取初始解向量及精度：$$X^{(0)}=\begin{bmatrix}1\\ 1\\ 1\end{bmatrix},\ \ \ \ \epsilon=0.01$$$$r^{(0)}=d^{(0)}=B-AX^{(0)}=\begin{bmatrix}6\\ 11\\ 13\end{bmatrix},\ \ \ \ \alpha_0=\frac{r^{(0)T}r^{(0)}}{d^{(0)T}Ad^{(0)}}=0.0923251$$$$X^{(1)}=X^{(0)}+\alpha_0d^{(0)}=\begin{bmatrix}1.55395\\ 2.01558\\ 2.20023\end{bmatrix}$$$$r^{(1)}=B-AX^{(1)}=\begin{bmatrix}-0.185783\\ 0.0133107\\ 0.0744831\end{bmatrix}$$误差不满足终止条件，继续迭代循环，采用 Fletcher-Reeves 更新求 beta：$$\beta_0=\frac{r^{(1)T}\ r^{(1)}}{r^{(0)T}\ r^{(0)}}=0.000123436$$$$d^{(1)}=r^{(1)}+\beta_0d^{(0)}=\begin{bmatrix}-0.185042\\ 0.0146685\\ 0.0760878\end{bmatrix}$$第二次迭代：$$\alpha_1=\frac{r^{(1)T}r^{(1)}}{d^{(1)T}Ad^{(1)}}=-2.46078$$$$X^{(2)}=X^{(1)}+\alpha_1d^{(1)}=\begin{bmatrix}2.00930\\ 1.97948\\ 2.01299\end{bmatrix}$$$$r^{(2)}=B-AX^{(2)}=\begin{bmatrix}-0.00723354\\ 0.0320342\\ -0.0237673\end{bmatrix}$$$$\beta_1=\frac{r^{(2)T}\ r^{(2)}}{r^{(1)T}\ r^{(1)}}=0.0408398$$第三次迭代：$$\alpha_2=\frac{r^{(2)T}r^{(2)}}{d^{(2)T}Ad^{(2)}}=0.628794$$$$X^{(3)}=X^{(2)}+\alpha_2d^{(2)}=\begin{bmatrix}2.00000\\ 2.00000\\ 2.00000\end{bmatrix}$$$$r^{(3)}=B-AX^{(3)}=\begin{bmatrix}-1.04361e-013\\ -1.86073e-013\\ -2.18492e-013\end{bmatrix}$$满足精度要求，终止迭代循环，取 $X^{(3)}$ 整数解，回代方程组验证成立，故得到线性方程组的解为：$$\begin{cases}x_1=2\\ x_2=2\\ x_3=2\end{cases}$$

- 上述题目编程迭代结果如下：
~~~
第 1 次迭代结果：x=1.55395, y=2.01558, z=2.20023, alpha=0.0923251, r=(-0.185783, 0.0133107, 0.0744831), beta=0.000123436, d=(-0.185042, 0.0146685, 0.0760878)

第 2 次迭代结果：x=2.0093, y=1.97948, z=2.01299, alpha=-2.46078, r=(-0.00723354, 0.0320342, -0.0237673), beta=0.0408398, d=(-0.0147906, 0.0326333, -0.0206599)

第 3 次迭代结果：x=2, y=2, z=2, alpha=0.628794, r=(-1.04361e-013, -1.86073e-013, -2.18492e-013), beta=5.67439e-023, d=(-1.04361e-013, -1.86073e-013, -2.18492e-013)

第 4 次迭代结果：x=2, y=2, z=2, alpha=0.0923142, r=(6.66134e-016, 8.88178e-016, 1.33227e-015), beta=3.22512e-005, d=(6.62768e-016, 8.82177e-016, 1.32522e-015)

第 5 次迭代结果：x=2, y=2, z=2, alpha=0.0944905, r=(0, 0, 0), beta=0, d=(0, 0, 0)
~~~


##### 双共轭梯度法 Biconjugate Gradient Method，BiCG / BCG：

- 共轭梯度法只适用于对称正定矩阵，双共轭梯度法可用于求解非对称线性方程组 $AX=B$

- 双共轭梯度法的基本思想是将原方程组 $AX=B$ 转化为两个相关的共轭梯度过程，一个用于求解 $AX=B$，另一个用于求解对偶方程组 $A^T\hat{X}=\hat{B}$，通过这两个共轭梯度过程的交替进行，逐步逼近原方程组的解

- 利用原始残差 $r_k$ 和对偶残差 $\widetilde{r}_k$ 的双正交性，确保算法的收敛性

- BiCG 法执行过程中与 CG 法的不同处：
	- 初始化时，取初始残差 $r_0=B-AX_0$，同时取初始对偶残差 $\widetilde{r}_0=r_0$；取初始搜索方向 $d_0=r_0$，并取初始对偶搜索方向 $\widetilde{d}_0=\widetilde{r}_0$
	- BiCG 法迭代计算步长公式为：$$\alpha_k=\frac{\widetilde{r}_k^T\ r_k}{\widetilde{d}_k^T\ Ad_k}$$
	- 每次更新残差 $r_{k+1}=r_k-\alpha_k Ad_k$ 时，更新对偶残差：$\widetilde{r}_{k+1}=\widetilde{r}_{1}-\alpha_k A^T\widetilde{d}_k$
	- 计算新的搜索方向：$d_{k+1}=r_{k+1}+\beta_kd_k$，$\widetilde{d}_{k+1}=\widetilde{r}_{k+1}+\beta_k\widetilde{d}_k$，其中 $\beta_k=\frac{\widetilde{r}_{k+1}^T\ r_{k+1}}{\widetilde{r}_k^T\ r_k}$
	- 终止条件为 $r_k$ 的范数小于设定阈值即可

##### 稳定双共轭梯度法 Biconjugate Gradient Stabilized Method，BiCGSTAB：

- 稳定双共轭梯度法是 BiCG 的一种改进版本，旨在解决 BiCG 收敛性不稳定的问题，其核心改进为：
	- 1. 多项式加速：使用一个多项式 $P_k(A)$ 对残差进行修正，以减少震荡
	- 2. 局部最小化：在每次迭代中，通过最小化残差的范数来确保解的更新是最优的

- BiCGSTAB 的初始化过程与 BiCG 类似，在迭代中更新解和残差方式有区别，其迭代过程为：
	- 1. 更新 BiCG 步长：$$\alpha_k=\frac{\widetilde{r}_k^T\ r_k}{\widetilde{d}_k^T\ Ad_k}$$
	- 2. 更新中间解：$$s_k=r_k-\alpha_kAd_k$$
	- 3. 计算稳定化步长：$$\omega_k=\frac{(As_k)^Ts_k}{(As_k)^T(As_k)}$$
	- 4. 更新解和残差：$$x_{k+1}=x_k+\alpha_kp_k+\omega_ks_k,\ \ \ \ r_{k+1}=s_k-\omega_kAs_k$$
	- 5. 计算新的搜索方向：$$\beta_k=\frac{\alpha_k}{\omega_k}\cdot\frac{\widetilde{r}_0^T\ r_{k+1}}{\widetilde{r}_0^T\ r_k},\ \ \ \ d_{k+1}=r_{k+1}+\beta_k(d_k-\omega_kAd_k)$$
当残差 $r_k$ 的范数小于预设阈值时，算法终止


#### 5. 广义最小残量法 Geneialized Minimal Residual Method，GMRES：

##### 广义最小残量法核心思想：

- GMRES 的核心思想在 Krylov 子空间中寻找使残差 $\Vert B-AX\Vert$ 最小的近似解，具体而言：
	- 1. 构建 Krylov 子空间：$$\mathcal{K}_k(A,r_0)=span\{r_0,\ Ar_0,\ A^2r_0,\ \cdots,\ A^{k-1}r_0\}$$其中 $r_0=B-AX_0$ 是初始残差
	- 2. 最小化残差：在 Krylov 子空间中寻找解 $x_k$，使得残差 $\Vert B-AX_k\Vert$ 最小

- GMRES 算法的基本步骤：
	- 1. 初始化：取初始解 $X_0$，初始残差为 $r_0=B-AX_0$，将初始残差归一化：$v_1=\frac{r_0}{\Vert r_0\Vert}$
	- 2. 迭代过程：对于 $k=1,2,\cdots$ 直到收敛：
		- 1. 通过 Arnoldi 过程生成 Krylov 子空间的正交基 $\{v_1,v_2,\cdots,v_k\}$，计算 $w=Av_k$ 并对 $w$ 进行正交化：$$h_{i,k}=(w,v_i),\ \ (i=1,2,\cdots,k)$$$$w=w-\Sigma_{i=1}^k\ h_{i,k}\ v_i$$再归一化 $w$：$$h_{k+1,k}=\Vert w\Vert,\ \ \ \ v_{k+1}=\frac{w}{h_{k+1,k}}$$
		- 2. 构建 Hessenberg 矩阵：将正交化系数 $h_{i,k}$ 存储为 Hessenberg 矩阵 $H_k$
		- 3. 最小化残差：在 Krylov 子空间中求解最小二乘问题：$$y_k=\arg{\min_y{\Vert\ \Vert r_0\Vert e_1-H_ky\ \Vert}}$$其中 $e_1=[1,0,\cdots,0]^T$，再更新近似解：$X_k=X_0+V_ky_k$，其中 $V_k=[v_1,v_2,\cdots,v_k]$
	- 3. 终止条件：当残差 $\Vert B-AX_k\Vert$ 的范数小于预设阈值时，算法终止

- GMERS 关键性质分析：
	- Krylov 子空间方法：GMERS 是一种 Krylov 子空间方法，其解 $x_k$ 属于 Krylov 子空间 $\mathcal{K}_k(A,r_0)$
	- 最小化残差：在每次迭代中，GMERS 通过最小化残差的 $2-$范数 来逼近解
	- 正交性：通过 Arnoldi 过程生成的基向量 $\{v_1,v_2,\cdots,v_k\}$ 相互正交

