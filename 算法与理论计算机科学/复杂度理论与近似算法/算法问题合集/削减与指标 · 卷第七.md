#### 1. 证明随机四舍五入 LP 松弛算法在多路切割问题是 $\frac{3}{2}-\frac{1}{k}$—近似算法

###### 问题描述：

· 考察如下利用线性规划（LP）近似求解多路切割问题的方法：

· 多路切割问题（Multiway Cut Problem）：目标是将图 $G=(V,E)$ 的顶点集合 $V$ 划分成 $k$ 个子集 $C_i$​，其中每个子集 $C_i$​ 包含一个特定的顶点 $s_i$​，并且这些子集的边切割成本最小化

· 线性规划表示：多路切割问题可以表示为一个整数规划问题：对于每个顶点 $u \in V$，定义 $k$ 个变量 $x_{iu}$​，如果顶点 $u$ 被分配到集合 $C_i$​，则 $x_{iu}=1$，否则 $x_{iu}=0$；同时，对于每条边 $e=(u,v)$，定义变量 $z_{ie}​$，如果边 $e$ 是割边，即 $e \in \delta(C_i)$，则 $z_{ie}=1$，否则 $z_{ie}=0$

· 整数规划模型的目标函数和约束条件如下：
1. 目标函数：$min\frac{1}{2}\sum_{e\in E}c_e\sum_{i=1}^kz_{ie}$
2. 约束条件：
	1. 每个顶点 $u$ 只能属于一个子集：$\sum_{i=1}^kx_{iu}=1,\ \ \forall u\in V$
	2. 如果边 $e=(u,v)$ 是割边，则：$$z_{ie}\geq x_{iu}-x_{iv},\ \ \forall e=(u,v)\in E$$$$z_{ie}\geq x_{iv}-x_{iu},\ \ \forall e=(u,v)\in E$$
	3. 特定顶点 $s_i$ 必须被分配到集合 $C_i$：$x_{is_i}=1,\  \ \forall i=1,\cdots,k$
	4. 变量 $x_{iu}$ 取 $0$ 或 $1$：$x_{iu}\in\{0,1\},\ \ \forall u\in V,i=1,\cdots,k$

· 线性规划松弛：将整数规划中的整数约束 $x_{iu} \in \{0, 1\}$ 放松为 $x_{iu} \geq 0$，得到线性规划松弛形式；每个顶点 $u$ 的变量 $x_{iu}$​ 可以看作是 $k$ 维向量 $x_u$​ 的第 $i$ 个坐标，这些向量位于 $k$—单纯形 $\Delta_k$​ 中

· 线性规划松弛形式的目标函数和约束条件如下：
1. 目标函数：$min\frac{1}{2}\sum_{e=(u,v)\in E}​c_e\Vert x_u​-x_v​\Vert_1​$
2. 约束条件：
	1. 特定顶点 $s_i$​ 被分配到集合 $C_i$：$x_{s_i}=e_i,\ \ \forall i=1,\cdots,k$
	2. 每个顶点的向量位于 $k$—单纯形中：$x_u\in\Delta_k,\ \ \forall u\in V$

· 随机四舍五入算法：通过随机四舍五入线性规划的解，可以得到一个近似的多路切割方案，算法步骤如下：
1. 选取 $r \in (0, 1)$ 均匀随机
2. 随机排列 $\{1, \ldots, k\}$ 得到顺序 $\pi$
3. 初始化每个集合 $C_i=\emptyset$
4. 按照随机顺序 $\pi$，依次将距离特定顶点 $s_{\pi(i)}$​ 较近的顶点分配到集合 $C_{\pi(i)}$
5. 最后，将所有未分配的顶点分配到最后一个集合 $C_{\pi(k)}$

· 该算法的性能保证分析通过概率分析和几何表示得出，可以得到一个 $\frac{3}{2}$​ 的近似比

· 证明上述多路割算法性能保证分析可以改进为 $\frac{3}{2}-\frac{1}{k}$

###### 问题求解：

· 引理 $1$ ：对于任意顶点 $u, v$ 和任意坐标 $l$，有：$\lvert x_u^l-x_v^l\rvert \leq \frac{1}{2} \Vert x_u - x_v\Vert_1$

· 引理 $2$：顶点 $u$ 属于 $B(s_i, r)$ 当且仅当 $1-x_u^i\leq r$

· 边被割的概率：根据算法，边 $(u, v)$ 被割的概率可以表示为：$$\Pr[(u, v) \text{ 被割}] = \sum_{i=1}^k \Pr[S_i \land X_i]$$其中 $S_i$​ 表示第 $i$ 个索引“决定”边 $(u,v)$ 的归属，$X_i$​ 表示第 $i$ 个索引“切割”边 $(u, v)$

· 根据引理 $1$：任意坐标 $l$ 对于距离 $\Vert x_u​−x_v​\Vert_1$​ 的贡献不超过一半；根据引理 $2$：事件 $X_i$ 的概率可以表示为：$Pr[X_i​]=Pr[min(1-x_u^i​,1-x_v^i​)\leq r<max(1-x_u^i​,1-x_v^i​)]=\lvert x_u^i​-x_v^i​\rvert$

· 设 $\ell$ 为最小化 $\min(1 - x_u^\ell, 1 - x_v^\ell)$ 的索引，即：$\ell = \arg \min_i \min(1 - x_u^i, 1 - x_v^i)$

· 对 $\ell$ 本身，有：$Pr[S_\ell\land X_\ell​]\leq Pr[X_\ell​]=\lvert x_u^\ell​-x_v^\ell\rvert$；对于每个 $i\neq\ell$，由于 $\ell$ 在随机排列 $\pi$ 中比 $i$ 更早出现的概率为 $\frac{1}{k}$，有：$Pr[S_i​\land X_i​]\leq\frac{1}{k}​Pr[X_i​]=\frac{1}{k}​\lvert x_u^i​-x_v^i​\rvert$

· 故：$$Pr[(u,v)\ 被割]\leq Pr[S_\ell​\land X_\ell​]+\sum_{i\neq\ell}​Pr[S_i​\land X_i​]$$$$\leq \lvert x_u^\ell​-x_v^\ell\rvert+\sum_{i\neq\ell}\frac{1}{k}​\lvert x_u^i​-x_v^i​\rvert$$$$\leq \frac{1}{2} \Vert x_u - x_v\Vert_1+\frac{1}{k}\sum_{i\neq\ell}​\lvert x_u^i​-x_v^i​\rvert$$$$\leq \frac{1}{2} \Vert x_u - x_v\Vert_1+\frac{1}{k}​(\Vert x_u-x_v\Vert_1-\lvert x_u^\ell​-x_v^\ell​\rvert)$$$$\leq \frac{1}{2} \Vert x_u - x_v\Vert_1+\frac{1}{k}​\Vert x_u-x_v\Vert_1$$$$=(\frac{1}{2}+\frac{1}{k})\Vert x_u-x_v\Vert_1$$$$\leq(\frac{3}{2}-\frac{1}{k})\Vert x_u-x_v\Vert_1,\ \ k\geq2时成立$$




进一步分析可知，对于任意一条边 $(u, v)$，若随机排列 $\pi$ 并选择 $r$，边 $(u, v)$ 被割的概率为：$$\Pr[(u, v) \text{ 被割}] \leq \frac{3}{2}\Vert x_u - x_v\Vert_1$$

· 由此证明得上述多路割算法性能保证分析可以改进为 $\frac{3}{2}-\frac{1}{k}$


#### 2. 证明贪心算法在解决 Steiner $k$—割问题时是 $(2-\frac{2}{k})$—近似算法

###### 问题描述：

· 在 Steiner $k$—割问题中，我们给定一个无向图 $G=(V,E)$，每条边 $e\in E$ 有一个非负代价 $c_e \geq 0$，一组终端点集合 $T\subseteq V$，以及一个正整数 $k \leq\lvert T\rvert$；问题目标是将顶点分成 $k$ 个集合 $S_1, S_2, \ldots, S_k$​，使得每个集合至少包含一个终端点（即 $S_i \cap T \neq \emptyset$ 对于 $i = 1, \ldots, k$ ），并且最小化在不同部分的顶点之间的边的权重；给定一个划分 $P = \{S_1, \ldots, S_k\}$，令 $c(P)$ 为端点在划分不同部分的边的总代价

· 考虑如下针对 Steiner $k$—割问题的贪心算法：我们从 $P = \{V\}$ 开始；只要 $P$ 中没有 $k$ 个部分，我们就考虑每个集合 $S \in P$ 且 $\lvert S\cap T\rvert\geq2$，考虑 $S\cap T$ 中每对终端点，并计算它们之间的最小代价割；然后选择在整个过程中找到的最小代价割；注意这会将某个集合 $S\in P$ 拆分成两个部分；用这两个新部分替换 $P$ 中的 $S$，并继续进行

【a】设 $P_i$​ 为算法找到的包含 $i$ 个部分的划分，设 $\hat{P} = \{V_1, V_2, \ldots, V_i\}$ 为任何一个有效的包含 iii 个部分的划分（即 $V_j \cap T \neq \emptyset$ 对于 $j = 1, \ldots, i$ ）；证明 $c(P_i) \leq \sum_{j=1}^{i-1} \sum_{e \in \delta(V_j)}c_e$

【b】利用以上证明，证明该贪心算法是 Steiner $k$—割问题的一个 $(2-\frac{2}{k})$—近似算法

###### 问题 a 求解：

1. 初始化：开始时，划分 $P_1=\{V\}$，显然 $c(P_1)=0$，这符合不等式
2. 归纳假设：假设对于某个 $i$，我们已经有 $c(P_i)\leq\sum_{j=1}^{i-1} \sum_{e \in \delta(V_j)} c_e$
3. 归纳步骤：
    - 在 $P_i$​ 基础上，算法选择代价最小的割 $c$ 将某个集合 $S$ 分成两个部分；设这个割的代价为 $c$，则 $P_{i+1}$​ 的划分代价为：$c(P_{i+1}) = c(P_i) + c$
    - 由于我们选择的是最小代价割，因此 c \leq \sum_{e \in \delta(V_j)} c_e$​ 对于任意有效划分 $\hat{P} = \{V_1, V_2, \ldots, V_i\}$
    - 于是有：$c(P_{i+1}) \leq \sum_{j=1}^{i-1} \sum_{e \in \delta(V_j)} c_e + \sum_{e \in \delta(V_i)} c_e = \sum_{j=1}^{i} \sum_{e \in \delta(V_j)} c_e$
4. 这完成了归纳证明，即 $c(P_i) \leq \sum_{j=1}^{i-1} \sum_{e \in \delta(V_j)} c_e$

###### 问题 b 求解：

· 在问题 a 中，我们已经证明了：$c(P_i) \leq \sum_{j=1}^{i-1} \sum_{e \in \delta(V_j)} c_e$​，对于任意有效的包含 $i$ 个部分的划分 $\hat{P} = \{V_1, V_2, \ldots, V_i\}$

· 设 $OPT$ 为 Steiner $k$—割问题的最优解的代价，假设 $\hat{P} = \{V_1, V_2, \ldots, V_k\}$ 是最优解对应的划分，那么有：$OPT = \sum_{e \in \delta(\hat{P})} c_e$​

· 将贪心算法的划分与最优划分比较：根据贪心算法的选择方式，可知每一步所选择的割的代价是当前最小的；因此对于每个 $i$ 来说，贪心算法所选择的割 $c$ 满足：$c \leq \sum_{e \in \delta(V_j)} c_e$​

· 需要证明：$c(P_k) \leq \left(2 - \frac{2}{k}\right) \cdot OPT$

· 利用问题 a 中的结果：$c(P_k) \leq \sum_{j=1}^{k-1} \sum_{e \in \delta(V_j)} c_e$​，注意到，对于最优解对应的划分 $\hat{P}$，有 $k$ 个部分 $V_1, V_2, \ldots, V_k$​，并且：$\sum_{j=1}^{k} \sum_{e \in \delta(V_j)} c_e = 2 \cdot OPT$

· 因为在每一步中，贪心算法选择的割的代价 $c$ 总是小于等于 \sum_{e \in \delta(V_j)} c_e，并且划分次数为 $k-1$ 次，可以得到：$c(P_k) \leq (k-1) \cdot \frac{2 \cdot OPT}{k}$

· 化简后得到：$c(P_k) \leq \left(2 - \frac{2}{k}\right) \cdot OPT$，由此证明出 $(2-\frac{2}{k})$ 的近似比


