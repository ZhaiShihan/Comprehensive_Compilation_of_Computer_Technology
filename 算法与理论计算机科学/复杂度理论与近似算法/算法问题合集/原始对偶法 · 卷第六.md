#### 1. 证明求解最短路径问题的原始对偶算法等价于 Dijkstra 算法

###### 问题描述：

· 考虑以下算法：

· 给定一个无向图 $G=(V,E)$，其中所有边 $e\in E$ 上都有非负的成本 $c_e\geq 0$，以及一对特殊的顶点 $s$ 和 $t$；目标是找到从 $s$ 到 $t$ 的最小成本路径

1. 最短路径问题可以通过以下整数规划模型来表示：$最小化\sum_{e\in E}c_ex_e$

· 约束条件：$\sum_{e\in\delta(S)}x_e\geq1,\ \forall S\in S^{'},\ x_e\in\{0,1\},\ \forall e\in E$，其中 $\delta(S)$ 是在集合 $S$ 中的顶点和不在 $S$ 中的顶点之间的所有边的集合，$S^{'}$ 是所有从 $s$ 到 $t$ 的割集

2. 通过将约束 $x_e\in\{0,1\}$ 放宽为 $x_e\geq0$ 并对其进行对偶化，得到以下对偶问题：$最大化\sum_{S\in S^{'}}y_S$

· 约束条件：$\sum_{S\in S^{'}:e\in\delta(S)}y_S\leq c_e,\ \forall e\in E,\ y_S\geq0,\ \forall S\in S^{'}$

· 算法步骤：
- 初始化：设 $y=0$，$F=\emptyset$
- 迭代：在没有 $s$ 到 $t$ 的路径存在于 $(V,F)$ 中时，执行以下操作：
    - 设 $C$ 为 $(V,F)$ 中包含 $s$ 的连通分量
    - 增加 $y_C$​ 直到存在一条边 $e^{'} \in \delta(C)$ 满足 $\sum_{S \in S^{'}: e' \in \delta(S)} y_S = c_{e'}$
    - 将边 $e^{'}$ 添加到 $F$ 中
- 返回：找到的 $s$ 到 $t$ 的路径

· 证明如上所示最短路径算法等价于 Dijkstra 算法：即在每一步中，它添加的边与 Dijkstra 算法添加的边相同

###### 问题求解：

· 等价性证明：
1. 初始状态：
    - Dijkstra 算法（D）：从起点 $s$ 开始，初始化所有顶点的距离为无穷大，只有 $s$ 的距离为0
    - 原始对偶算法（P）：$y=0$，$F=\emptyset$
2. 选择边的过程：
    - D：每一步选择未处理顶点中距离 $s$ 最近的顶点 $v$，更新从 $v$ 到其邻接顶点的距离
    - P：在当前边集合 $F$ 中没有 $s$ 到 $t$ 的路径时，找到包含 $s$ 的连通分量 $C$，增加 $y_C$​ 直到某条边 $e^{'}$ 的对偶约束变为紧约束，即 $\sum_{S \in S^{'}: e' \in \delta(S)} y_S = c_{e'}$
3. 边的更新：    
    - D：更新邻接顶点的距离，选择当前最短路径中的下一条边 $e^{'}=(v,u)$，其中 $d(u) = \min(d(u), d(v) + c_{vu})$
    - 原始对偶算法：选择的边 $e^{'}$ 是在增加 $y_C$​ 过程中变为紧约束的边 $e^{'}=(v,u)$，即满足 $\sum_{S \in \mathcal{S}: e' \in \delta(S)} y_S = c_{e'}$

· 由此等价性得证


#### 2. 证明使用原对偶方法求解树中多路切割问题的算法是一个 $2$—近似算法

###### 问题描述：

· 在树中的多路切割问题中，我们给定一棵树 $T=(V,E)$，以及 $k$ 对顶点对 $s_i​-t_i$​，每条边 $e\in E$ 具有成本 $c_e\geq 0$

· 目标是找到一个最小成本的边集 $F$，使得对于所有 $i$，顶点 $s_i$​ 和 $t_i$​ 在图 $G^{'}=(V,E-F)$ 中位于不同的连通分量中；设 $P_i$​ 为树 $T$ 中从 $s_i$​ 到 $t_i$​ 的唯一路径上的边集；则可以将这个问题表述为以下整数规划：$$最小化\sum_{e\in E}c_ex_e$$$$约束条件\sum_{e\in P_i}x_e\geq 1,\ 1\leq i\leq k,\ x_e\in\{0,1\},\ e\in E$$

· 假设在任意顶点 $r$ 处对树进行根植：令 $\text{depth}(v)$ 表示从顶点 $v$ 到根 $r$ 的路径上的边数；令 $\text{lca}(s_i, t_i)$ 为从 $s_i$​ 到 $t_i$​ 的路径上深度最小的顶点；假设使用原对偶法来解决这个问题，在每次迭代中增加的对偶变量对应于违反的约束，使得 $\text{depth}(\text{lca}(s_i, t_i))$ 最大

· 证明这种方法为树中的多路切割问题提供了一个 $2$—近似算法

###### 问题求解：

· 对应的对偶问题为：$max\sum_{i=1}^{k}y_i$，约束条件为：$\sum_{i:e\in P_i}y_i\leq c_e,\ y_i\geq 0,\ 1\leq i\leq k,\ e\in E$

· 原始对偶算法：
1. 初始化所有对偶变量 $y_i=0$
2. 在每次迭代中，找到违反约束条件的对偶变量 $y_i$ 使得 $\text{depth}(\text{lca}(s_i, t_i))$ 最大
3. 增加该对偶变量，直到某个原始约束条件被饱和，即 $\sum_{i:e\in P_i}y_i=c_e$ 对于某些边 $e$
4. 选择所有被饱和的边形成集合 $F$

· 近似比分析：
1. 在每次迭代中，当某条边 $e$ 被添加到集合 $F$ 中时，对应的对偶约束 $\sum_{i:e\in P_i}y_i=c_e$ 被饱和；由于对偶约束在任何时候都满足 $\sum_{i:e\in P_i}y_i\leq c_e$​，因此对偶解 $y$ 是一个可行解
2. 设 $C(F)$ 为边集 $F$ 的成本，显然 $C(F)=\sum_{e\in F} c_e$，由于每个对偶变量 $y_i$​ 最多可以将一条边的成本 $c_e$​ 分配给与该边相关的路径 $P_i$；对于任意一对顶点 $s_i$​ 和 $t_i$​，路径上的每条边 $e$ 被添加到集合 $F$ 的成本至少为 $y_i$​
3. 双重计数法则：每条边连接的两个顶点最多只能在两条不同路径上分别出现，每条边 e 的成本 $c_e$​ 在两个路径中累积，对偶变量最多增加到 $c_e$​，所以总成本 $C(F)$ 至多是对偶值总和的两倍，因此有：$$C(F)=\sum_{e\in F}c_e\leq 2\sum_{i=1}^ky_i$$
4. 由此近似比为 $2$


#### 3. 用局部比例定理证明集合覆盖问题的局部比例算法是 $f$—近似算法

###### 问题描述：

· 局部比例技术是一种高度相关于原始对偶方法的技术；然而，它对对偶性的使用是隐性的

· 考虑以下用于集合覆盖问题的局部比例算法：与原始对偶算法一样，计算一个集合 $I$ 的索引集合，它是一个集合覆盖，其中 $I$ 初始为空；在每次迭代中，找到当前集合 $I$ 尚未覆盖的某个元素 $e_i$；设 $\epsilon$ 为包含 $e_i$​ 的任何集合的最小权重；从每个包含 $e_i$​ 的集合的权重中减去 $\epsilon$；现在某个这样的集合的权重为零，将该集合的索引添加到 $I$

· 分析这个算法的性能，设 $\epsilon_j$ 为算法第 $j$ 次迭代的 $\epsilon$ 值

【a】证明返回解的成本至多为 $f\sum_j\epsilon_j$，其中 $f=max_i\lvert\{j:e_i\in S_j\}\rvert$

【b】证明最优解的成本至少为 $\sum_j\epsilon_j$

【c】得出结论：是该算法是一个 $f$—近似算法

· 在其最普遍的应用中，局部比例技术依赖于局部比例定理，如下所述：对于一个具有权重 $w$ 的最小化问题 $\Pi$，如果可行解 $F$ 对权重 $w$ 是 $\alpha$ 近似的，则意味着 $F$ 的权重至多是给定权重 $w$ 下最优解权重的 $\alpha$ 倍

· 局部比例定理指出，如果我们有非负权重 $w$ ，使得 $w=w_1+w_2$​，其中 $w_1$​ 和 $w_2$​ 也是非负权重，并且我们有一个可行解 $F$，使得 $F$ 对 $w_1$​ 和 $w_2$​ 都是 $\alpha$ 近似的，那么 $F$ 对 $w$ 也是 $\alpha$ 近似的

【d】证明局部比例定理

【e】解释上述集合覆盖算法如何根据局部比例定理进行分析以证明它是一个 $f$—近似算法

· 大多数原始对偶算法都有局部比例变种

###### 问题 a 求解：

· 在每次迭代中，从包含未覆盖元素 $e_i$​ 的集合的权重中减去 $\epsilon_j$​，并将权重为零的集合的索引加入到解 $I$ 中，对于一个集合中的 $e_i$ 来说，总成本为所有这些 $\epsilon_j$​ 的和：$$总成本=\sum_j\epsilon_j$$

· $f$ 表示同一个元素出现在不同集合的最大次数，故由于每个元素 $e_i$​ 最多出现在 $f$ 个集合中：$$总成本\leq f\sum_j\epsilon_j$$

###### 问题 b 求解：

· 最优解必须覆盖所有元素 $e_i$​，在每次迭代中，从包含 $e_i$​ 的集合权重中减去的 $\epsilon_j$​ 是这些集合的一部分；换言之，最优解的成本必须至少为所有 $\epsilon_j$​ 的总和，因为这是我们在每次迭代中减少的权重：$$最优解成本\geq\sum_j\epsilon_j$$

###### 问题 c 求解：

· 由【a】和【b】：算法解的成本不大于 $f\sum_j\epsilon_j$，最优解的成本不小于 $\sum_j\epsilon_j$，由此得：$$\frac{算法解成本}{最优解成本}\leq\frac{f\sum_j\epsilon_j}{\sum_j\epsilon_j}=f$$

· 由此可以得到：这是一个 $f$—近似算法

###### 问题 d 求解：

· 定义 $OPT_w$ 为对权重 $w$ 的最优解，$OPT_{w_1}$​ 和 $OPT_{w_2}$​​ 分别是对权重 $w_1$​ 和 $w_2$​ 的最优解

· 根据定义：$w_1(F) \leq \alpha \cdot w_1(OPT_{w_1})$，$w_2(F) \leq \alpha \cdot w_2(OPT_{w_2})$

· 因此：$w(F) = w_1(F) + w_2(F) \leq \alpha \cdot w_1(OPT_{w_1}) + \alpha \cdot w_2(OPT_{w_2})$

· 由于 $OPT_{w_1}$​​ 和 $OPT_{w_2}$​​ 是分别针对 $w_1$​ 和 $w_2$​ 的最优解，所以：$w_1(OPT_{w_1}) \leq w_1(OPT_w)$，$w_2(OPT_{w_2}) \leq w_2(OPT_w)$

· 所以：$w(F) \leq \alpha \cdot (w_1(OPT_w) + w_2(OPT_w))$，$w(F) \leq \alpha \cdot w(OPT_w)$

· 这表明 $F$ 对 $w$ 也是 $\alpha$ 近似的，由此证明了局部比例定理

###### 问题 e 求解：

· 由于每次选择的 $\epsilon_j$​ 保证局部最优性，可以应用局部比例定理：解 $I$ 的总成本 $\leq f \sum_j \epsilon_j$​，因为每个元素 $e_i$ 最多出现在 $f$ 个集合中，最优解的成本 $\geq \sum_j \epsilon_j$​

· $\frac{算法解成本​​}{最优解成本}​\leq\frac{f\sum_j\epsilon_j}{\sum_j\epsilon_j}=f$，因此该算法是一个 $f$—近似算法


#### 4. 使用经典原始-对偶算法构建一棵满足成本界限的斯坦纳树

###### 问题描述：

· 对于奖惩斯坦纳树问题，使用如下的线性规划松弛模型来描述该问题：$$\text{最小化} \sum_{e \in E} c_e x_e + \sum_{i \in V} \pi_i (1 - y_i)$$满足以下约束条件：$$\sum_{e \in \delta(S)} x_e \geq y_i,\ \forall i \in S,\ \forall S \subseteq V - r,\ S \neq \emptyset$$$$y_r = 1,\ y_i \geq 0,\ \forall i \in V,\ x_e \geq 0,\ \forall e \in E$$给定线性规划的一个最优解 $(x^*, y^*)$，我们选择一个顶点集合 $U$，使得：$$U = \{i \in V: y^*_i \geq \alpha\}$$对于某个 $\alpha>0$ 的值

· 请给出一个原始—对偶算法来找到一棵在顶点集合 $U$ 上的斯坦纳树 $T$，使得：$$\sum_{e \in T} c_e \leq 2\alpha \sum_{e \in E} c_e x^*_e$$（提示：不需要设计一个新的原始-对偶算法）

###### 问题求解：

· 经典原始-对偶算法步骤:
1. **初始化**：
    - 设初始边集 $T=\emptyset$
    - 设初始顶点集合 $U = \{r\}$，其中 $r$ 是根节点
    - 设初始对偶变量 $\{y_i\}$ 和 $\{x_e\}$ 均为零
2. **增长阶段**：
    - 当 $U$ 中不包括所有满足 $y_i^* \geq \alpha$ 的顶点时：
        - 均匀地增加对偶变量 $y_i$​ 和 $x_e$​，直到某个约束变得紧，即某条边 $e = (u, v)$ 的约束 $\sum_{e \in \delta(S)} x_e \geq y_i$​ 变为等式
        - 将该边 $e$ 加入边集 $T$，即 $T = T \cup \{e\}$
        - 更新顶点集合 $U$，即 $U = U \cup \{u, v\}$
3. **终止条件**：
    - 当顶点集合 $U$ 包含所有 $y_i^* \geq \alpha$ 的顶点时，算法终止
4. **构建斯坦纳树**：
    - 结果树 $T$ 包含了所有在顶点集合 $U$ 上形成的斯坦纳树的边

· 成本界限证明：树 $T$ 的总成本为：$\sum_{e \in T} c_e \leq 2 \alpha \sum_{e \in E} c_e x^*_e$​
- 每条边 $e$ 是在其对应的对偶约束变得紧时添加的
- 总成本被界定为对偶变量总和的两倍，因为对偶变量的增加与边的加入是同步的，且每个对偶变量的增加都对应边的成本


#### 5. 证明使用原对偶方法求解无容量设施选址问题的算法是 $3$—近似算法

###### 问题描述：

· 考察下面的无容量设施选址问题的原始—对偶算法：

· 问题描述：无容量设施选址问题的输入包括一组客户 $D$ 和一组设施 $F$，每个设施 $i$ 的设施成本为 $f_i$​，并且每个设施 $i$ 和客户 $j$ 之间的分配成本为 $c_{ij}$；目标是选择一组要开启的设施，并为这些设施分配客户，以最小化开启设施的总成本和分配成本的总和

· 线性规划松弛：问题的线性规划松弛形式为：$$\text{最小化} \quad \sum_{i \in F} f_i y_i + \sum_{i \in F, j \in D} c_{ij} x_{ij}$$$$\text{约束条件} \quad \sum_{i \in F} x_{ij} = 1, \quad \forall j \in D$$$$x_{ij} \leq y_i, \quad \forall i \in F, j \in D$$$$x_{ij} \geq 0, \quad \forall i \in F, j \in D$$$$y_i \geq 0, \quad \forall i \in F$$
其中，变量 $x_{ij}$​ 表示客户 $j$ 是否被分配到设施 $i$，变量 $y_i$​ 表示设施 $i$ 是否被开启。

· 对偶问题：线性规划松弛问题的对偶形式为：
$$\text{最大化} \quad \sum_{j \in D} v_j$$$$\text{约束条件} \quad \sum_{j \in D} w_{ij} \leq f_i, \quad \forall i \in F$$$$v_j - w_{ij} \leq c_{ij}, \quad \forall i \in F, j \in D$$
其中，对偶变量 $v_j$​ 表示客户 $j$ 愿意支付的成本，$w_{ij}$​ 表示分摊给客户 $j$ 的设施 $i$ 的成本份额

· 原始-对偶算法：该算法的主要思想是通过增加对偶变量 $v_j$​ 来生成一个极大化的对偶解 $(v^*,w^*)$，并选择一组设施来满足所有客户的需求；以下是算法的步骤：
1. 初始化：令 $v \leftarrow 0, w \leftarrow 0$，客户集合 $S \leftarrow D$，设施集合 $T \leftarrow \emptyset$
2. 增加对偶变量：均匀增加所有 $j \in S$ 的 $v_j$​ 和所有 $i \in N(j), j \in S$ 的 $w_{ij}$​，直到某个客户 $j \in S$ 与某个设施 $i$ 邻接，或某个设施 $i$ 的对偶不等式变为紧等式
3. 更新集合：
	- 如果某个客户 $j \in S$ 与某个设施 $i \in T$ 邻接，则将 $j$ 从 $S$ 中移除
    - 如果某个设施 $i$ 的对偶不等式变为紧等式，则将 $i$ 加入 $T$，并将所有与 $i$ 邻接的客户从 $S$ 中移除
4. 迭代选择：当 $S$ 为空且每个客户都邻接某个设施时，从 $T$ 中选择一个子集 $T^{'}$，使得每个客户至多只为 $T^{'}$ 中的一个设施分摊成本。具体方法是迭代地选择任意 $i\in T$，然后删除所有使得存在某个客户同时为 $i$ 和其他设施 $i^{'}\in T$ 分摊成本的设施 $i^{'}$
5. 分配客户：打开所有 $T^{'}$ 中的设施，并将每个客户分配到离它最近的已打开设施  

· 算法步骤
1. 初始化变量和集合
2. 均匀增加对偶变量，直到某个条件满足
3. 更新设施和客户集合
4. 迭代选择设施子集 $T^{'}$
5. 将客户分配给最近的已打开设施

· 算法通过引入紧等式和三角不等式的使用，保证了每个客户到设施的距离不会超过其对偶变量的三倍，从而确保了算法的性能保证，最终得到该算法是一个 $3$—近似算法

· 证明上述关于无容量设施选址问题的原始—对偶算法的性能保证可以通过以下方式加强：假设算法打开了一组 $T$ ′的设施并构造了对偶解 $(v,w)$；证明：
$$\sum_{j \in D} \min_{i \in T'} c_{ij} + 3 \sum_{i \in T'} f_i \leq 3 \sum_{j \in D} v_j$$

###### 问题求解：

1. 对于每个客户 $j \in D$，对偶变量 $v_j$​ 满足：$v_j - w_{ij} \leq c_{ij}\ \ \forall i \in F, j \in D$
2. 对于每个设施 $i \in T^{'}$，对偶不等式变为紧等式：$\sum_{j \in D} w_{ij} = f_i$​
3. 对于每个客户 $j$，其到 $T^{'}$ 中最近设施的分配成本为 $\min_{i \in T'} c_{ij}$
4. 设施 $T′$ 的总成本为：$\sum_{i \in T'} f_i = \sum_{i \in T'} \sum_{j \in D} w_{ij}$
5. 对于每个客户 $j$，由对偶变量和分配成本的关系可得：$v_j \leq \min_{i \in T'} c_{ij} + \sum_{i \in T'} w_{ij}$，因此：$\sum_{j\in D}min_{i\in T^{'}}​c_{ij}​\leq\sum_{j\in D}​(v_j​−\sum_{i\in T^{'}}​w_{ij}​)$
6. 由于 $\sum_{i \in T'} f_i = \sum_{i \in T'} \sum_{j \in D} w_{ij}$，得到：$$\sum_{j \in D} \min_{i \in T'} c_{ij} + 3 \sum_{i \in T'} f_i \leq 3 \sum_{j \in D} v_j$$原始—对偶算法的性能保证得以加强

